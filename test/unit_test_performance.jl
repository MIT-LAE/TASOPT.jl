@testset "performance" verbose=true begin
    ac = load_default_model()
    size_aircraft!(ac; printiter=false);
    FL = float([  0 ,    5 ,   10 ,   15 ,   20 ,   
            30 ,   40 ,   60 ,   80 ,  100 , 
            120 ,  140 ,  160 ,  180 ,  200 ,
            220 ,  240 ,  260 ,  280 ,  290 , 
            310 ,  330 ,  350 ,  370 ,  390 ,
            410])

    parg = ac.parg
    ZFW = parg[igWMTO] - parg[igWfuel]
    OEW = parg[igWMTO] - parg[igWfuel] - parg[igWpay]
            
    M_high = 0.92 * parg[igWMTO]
    M_low = 0.45 * parg[igWMTO] +(0.63 * (parg[igWMTO]^0.924))
    W = [parg[igWMTO], 1/3*(OEW+2*parg[igWMTO]), 1.2*OEW]
    Wpaymax = parg[igWpaymax]
    Ldebug = false

    @testset "off design performance" begin
        high_outputs_correct = (871964.0207817988, 12496.800000000001, [80.81275720164649, 81.39379412431006, 81.98161188263717, 85.20233995064308, 85.82234928001363, 97.80729092781559, 115.54249464124159, 140.08552139650615, 144.25638080841546, 177.77537021190292, 183.0601797378208, 188.5521173101196, 194.25360270400643, 200.1661063467623, 206.2900340467326, 212.62461202148936, 219.16777682424814, 225.91608887758503, 232.86479312886004, 236.41264441866187, 241.43705872286955, 239.359920983201, 237.4846310775805, 236.35362144223177, 236.03584679797737, 235.983685523832], [144.08971775773998, 145.12857265635765, 151.24951930762006, 162.5587648643785, 194.5760978175237, 229.58504471848303, 232.9307613515055, 272.30682178000575, 280.4143939204095, 334.27036197570885, 344.26328208608953, 354.6533091966123, 365.4458194048345, 376.6444562446586, 388.25090879628647, 400.2646880695055, 412.68291006191595, 425.5001205402086, 438.70839420244005, 445.45639573697844, 459.2388851020328, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [2333.272628626102, 2343.998990687479, 2354.775497558933, 2461.6506055393843, 2594.690027622894, 2971.249193702125, 3041.1816656466767, 3831.730046356637, 3892.9422502267425, 4188.379906269898, 4246.839410797264, 4306.799017255351, 4368.359226257682, 4431.67537567947, 4497.185269991155, 4565.084705443363, 4634.741483893307, 4705.933688929981, 4778.815416613268, 4816.598711689656, 4884.939388076904, 4925.778966262865, 4947.219778922841, 4941.242456271678, 4858.086316081206, 4461.366506384548], [1.3318227166424335, 1.3317428246642518, 1.331661180512331, 1.3312744746972827, 1.3311838969006098, 1.3296243899409974, 1.3269640258669588, 1.3225081659756572, 1.3214945207521955, 1.3138476302351145, 1.312207080187059, 1.3104257740640517, 1.3084920372195032, 1.30639346651045, 1.304116930479839, 1.3016485951454277, 1.2989739235770168, 1.2960776970274777, 1.2929440645386696, 1.2912831071489095, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.962761792417254, 0.9683433017064123, 0.9745532010859957, 0.980475136265796, 1.0227549402347376, 1.0283144842650545, 1.0338012419192808, 1.0392328131378337, 1.0445971809187848, 1.0498341177000243, 1.0550423630410108, 1.0600680594064433, 1.0624668550968503, 1.0674580180559814, 1.0795368198074509, 1.0716950953818953, 1.0776773546827387, 1.1162981123401372, 1.251161372645379], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 272.30682178000575, 280.4143939204095, 288.8726703929836, 297.6912462923113, 342.7558745030535, 353.25127374797063, 364.14805983243093, 375.44878601788986, 387.15394727893124, 399.2617620445512, 411.7679915944973, 424.6660222141039, 431.2595993728225, 444.7353321785322, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3225081659756572, 1.3214945207521955, 1.3203943713512525, 1.3192005751120037, 1.313552399575026, 1.3118384865249741, 1.3099760331552928, 1.307952855734694, 1.305756049401886, 1.3033719988061, 1.3007864144161527, 1.2979843274779337, 1.296497243643069, 1.2933409699076417, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3821.9337886820363, 3883.3703662278513, 3942.597982939405, 4003.7550482753045, 4271.552864018898, 4334.569749928112, 4399.011952429724, 4464.843757914876, 4532.161267970008, 4601.293986885632, 4671.894430037575, 4744.522333959296, 4781.786081451347, 4856.321074787556, 4950.147847074484, 4950.240469495438, 4895.965949585487, 4693.343615969113, 3985.3832433617335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1616.3293433724123, 1616.4564988798431, 1616.5944736030895, 1616.7441553290769, 1617.451779721684, 1617.6663145713503, 1617.899339111206, 1618.1523525881964, 1618.4269400021462, 1618.7247702572838, 1619.047591134324, 1619.3972293700215, 1619.5826958883029, 1619.976142034272, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.614516677578298, 16.93841408738772, 17.307383715031968, 17.693866957806144, 20.304258311305446, 20.87136057307948, 21.48359125021882, 22.14674616091653, 22.865838428956884, 23.643933903191673, 24.492783523970605, 25.415326663625056, 25.905353377337516, 26.973487036904665, 28.94670709295976, 28.458792604097372, 28.830276712069146, 31.342357575480413, 41.75620265670997], [32.827607915561565, 32.846943521241364, 32.866715646648295, 32.96053714577686, 32.98255380352192, 33.364067830937316, 34.02565922770097, 35.164703050330054, 35.42931477533054, 37.49232564264808, 37.95035673122765, 38.45388929349041, 39.0078821554164, 39.61785975178672, 40.28997934234334, 41.031101801160894, 41.84888160477037, 42.75186479233961, 43.74959409049834, 44.287272744115754, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01652295377157145, 0.016618743842061065, 0.016725318366707865, 0.01682695083902317, 0.017552558410856643, 0.017647971512755198, 0.017742135452153935, 0.017835352279886387, 0.017927415759717492, 0.018017292263981136, 0.01810667636467759, 0.01819292755305047, 0.01823409577411222, 0.018319754298878815, 0.018527051144814524, 0.018392471177897118, 0.018495138935026547, 0.01915794981765835, 0.02147247811848769], 12496.800000000001)
        
        nom_outputs_correct = (737014.41698953, 12496.800000000001, [80.81275720164649, 81.39379412431006, 81.98161188263717, 85.20233995064308, 85.82234928001363, 97.80729092781559, 115.54249464124159, 140.08552139650615, 144.25638080841546, 177.77537021190292, 183.0601797378208, 188.5521173101196, 194.25360270400643, 200.1661063467623, 206.2900340467326, 212.62461202148936, 219.16777682424814, 225.91608887758503, 232.86479312886004, 236.41264441866187, 241.43705872286955, 239.359920983201, 237.4846310775805, 236.35362144223177, 236.03584679797737, 235.983685523832], [144.08971775773998, 145.12857265635765, 151.24951930762006, 162.5587648643785, 194.5760978175237, 229.58504471848303, 232.9307613515055, 272.30682178000575, 280.4143939204095, 334.27036197570885, 344.26328208608953, 354.6533091966123, 365.4458194048345, 376.6444562446586, 388.25090879628647, 400.2646880695055, 412.68291006191595, 425.5001205402086, 438.70839420244005, 445.45639573697844, 459.2388851020328, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [3076.296850246712, 3091.385910505497, 3106.564584105147, 3223.989147105516, 3353.3954273651834, 3767.643913782902, 4233.218189604712, 4724.376844153252, 4803.533656427296, 5114.740329765794, 5190.498104755378, 5268.237760235293, 5348.061850013421, 5430.269398029222, 5515.583654400011, 5604.23344936433, 5695.611117755101, 5789.803248233075, 5887.239032232103, 5936.005996183803, 6034.239425362448, 6112.605988902222, 6172.119940348691, 6225.849578558988, 6276.309083354829, 6290.58288569019], [1.3318227166424335, 1.3317428246642518, 1.331661180512331, 1.3312744746972827, 1.3311838969006098, 1.3296243899409974, 1.3269640258669588, 1.3225081659756572, 1.3214945207521955, 1.3138476302351145, 1.312207080187059, 1.3104257740640517, 1.3084920372195032, 1.30639346651045, 1.304116930479839, 1.3016485951454277, 1.2989739235770168, 1.2960776970274777, 1.2929440645386696, 1.2912831071489095, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9050874616434522, 0.9102544383311798, 0.9160215811726174, 0.9214610165203062, 0.9757605445548742, 0.9808221307248259, 0.9857708454094692, 0.9905993708361139, 0.9952793490872816, 0.9997215069561833, 1.003985005426131, 1.0081691544152522, 1.0102576268640842, 1.0142610742682094, 1.0258514024860017, 1.0102124021071606, 0.9986056480018924, 0.9934150810625675, 1.0026922807545362], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 272.30682178000575, 280.4143939204095, 288.8726703929836, 297.6912462923113, 342.7558745030535, 353.25127374797063, 364.14805983243093, 375.44878601788986, 387.15394727893124, 399.2617620445512, 411.7679915944973, 424.6660222141039, 431.2595993728225, 444.7353321785322, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3225081659756572, 1.3214945207521955, 1.3203943713512525, 1.3192005751120037, 1.313552399575026, 1.3118384865249741, 1.3099760331552928, 1.307952855734694, 1.305756049401886, 1.3033719988061, 1.3007864144161527, 1.2979843274779337, 1.296497243643069, 1.2933409699076417, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4724.6932408703215, 4804.540878859947, 4881.905088550502, 4961.9634320174555, 5260.022592182497, 5342.264283893383, 5426.674899556657, 5513.3677418275065, 5602.5867784298, 5694.920678582062, 5790.253035315734, 5888.234470732672, 5938.022381606098, 6040.0774655786145, 6168.149624921624, 6209.108930297448, 6244.665849453561, 6264.630650323614, 6209.705537196865], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1616.3293433724123, 1616.4564988798431, 1616.5944736030895, 1616.7441553290769, 1617.451779721684, 1617.6663145713503, 1617.899339111206, 1618.1523525881964, 1618.4269400021462, 1618.7247702572838, 1619.047591134324, 1619.3972293700215, 1619.5826958883029, 1619.976142034272, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.911962875179034, 15.171475611395358, 15.467874800815082, 15.777754184675382, 18.426314006040226, 18.908177231893983, 19.428413963544273, 19.99096618643062, 20.59925269479015, 21.25425421625493, 21.963771724460685, 22.73875436974262, 23.15571603195417, 24.048353607532764, 25.768024261535924, 24.91243758747008, 24.297531468361477, 24.02802333107816, 24.512097120494715], [32.827607915561565, 32.846943521241364, 32.866715646648295, 32.96053714577686, 32.98255380352192, 33.364067830937316, 34.02565922770097, 35.164703050330054, 35.42931477533054, 37.49232564264808, 37.95035673122765, 38.45388929349041, 39.0078821554164, 39.61785975178672, 40.28997934234334, 41.031101801160894, 41.84888160477037, 42.75186479233961, 43.74959409049834, 44.287272744115754, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01553314475683144, 0.01562182060336224, 0.015720796523796175, 0.01581414831600602, 0.016746038840328447, 0.0168329059708644, 0.016917835996761835, 0.01700070333013305, 0.01708102129134114, 0.017157257770283253, 0.017230428089960396, 0.017302236610889584, 0.017338079052911105, 0.01740678636650235, 0.017605700011443636, 0.01733730290394688, 0.017138107357312405, 0.017049026654004287, 0.01720824230095593], 12496.800000000001)

        low_outputs_correct = (560538.251285991, 12496.800000000001, [80.81275720164649, 81.39379412431006, 81.98161188263717, 85.20233995064308, 85.82234928001363, 97.80729092781559, 115.54249464124159, 140.08552139650615, 144.25638080841546, 177.77537021190292, 183.0601797378208, 188.5521173101196, 194.25360270400643, 200.1661063467623, 206.2900340467326, 212.62461202148936, 219.16777682424814, 225.91608887758503, 232.86479312886004, 236.41264441866187, 241.43705872286955, 239.359920983201, 237.4846310775805, 236.35362144223177, 236.03584679797737, 235.983685523832], [144.08971775773998, 145.12857265635765, 151.24951930762006, 162.5587648643785, 194.5760978175237, 229.58504471848303, 232.9307613515055, 272.30682178000575, 280.4143939204095, 334.27036197570885, 344.26328208608953, 354.6533091966123, 365.4458194048345, 376.6444562446586, 388.25090879628647, 400.2646880695055, 412.68291006191595, 425.5001205402086, 438.70839420244005, 445.45639573697844, 459.2388851020328, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [3858.692472905758, 3872.2246915141495, 3885.6741227485595, 4373.719122568746, 4458.9353216605, 5259.735659057589, 5864.013460946836, 6455.0164678542205, 6567.847587899373, 6383.176168266793, 6504.988057531363, 6632.383996115227, 6765.720454587833, 6905.430135630596, 7052.317167446866, 7206.808735691048, 7369.010657038549, 7539.055948092745, 7712.326926592355, 7802.027656557362, 8039.723613891015, 8334.294590027654, 8503.697320625752, 8627.991463303259, 8754.293361281298, 8867.743754589017], [1.3318227166424335, 1.3317428246642518, 1.331661180512331, 1.3312744746972827, 1.3311838969006098, 1.3296243899409974, 1.3269640258669588, 1.3225081659756572, 1.3214945207521955, 1.3138476302351145, 1.312207080187059, 1.3104257740640517, 1.3084920372195032, 1.30639346651045, 1.304116930479839, 1.3016485951454277, 1.2989739235770168, 1.2960776970274777, 1.2929440645386696, 1.2912831071489095, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8426362183283325, 0.8473390125156984, 0.8525932685757541, 0.8574616293332491, 0.9269387308221874, 0.9310721789162628, 0.9350666724776087, 0.9389121180434419, 0.9425741065324444, 0.9459704584602666, 0.949175688553314, 0.9522581814694938, 0.9537888511698048, 0.9566889154517005, 0.9692463798756326, 0.9465231091141749, 0.9270754163283218, 0.9108912212439445, 0.8979867019129322], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 272.30682178000575, 280.4143939204095, 288.8726703929836, 297.6912462923113, 342.7558745030535, 353.25127374797063, 364.14805983243093, 375.44878601788986, 387.15394727893124, 399.2617620445512, 411.7679915944973, 424.6660222141039, 431.2595993728225, 444.7353321785322, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3225081659756572, 1.3214945207521955, 1.3203943713512525, 1.3192005751120037, 1.313552399575026, 1.3118384865249741, 1.3099760331552928, 1.307952855734694, 1.305756049401886, 1.3033719988061, 1.3007864144161527, 1.2979843274779337, 1.296497243643069, 1.2933409699076417, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523, 1.2886161696704523], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6472.528660905125, 6587.4768970539135, 6699.042535438052, 6814.745052241988, 7173.945642268847, 7294.4444902387995, 7418.471889490648, 7546.223871600729, 7678.084800019908, 7814.800378577719, 7956.17957609085, 8102.065118640155, 8176.558155122767, 8329.680152267512, 8510.843878170825, 8607.158654347117, 8702.416591278588, 8801.95616560616, 8887.304207873742], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1616.3293433724123, 1616.4564988798431, 1616.5944736030895, 1616.7441553290769, 1617.451779721684, 1617.6663145713503, 1617.899339111206, 1618.1523525881964, 1618.4269400021462, 1618.7247702572838, 1619.047591134324, 1619.3972293700215, 1619.5826958883029, 1619.976142034272, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728, 1620.5646225917728], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.391145215656442, 13.59240253742387, 13.822488628033444, 14.062093080519581, 16.723171459828208, 17.11213146434535, 17.5325932682666, 17.987789347724622, 18.48033234846256, 19.011167491946757, 19.58748654484977, 20.21717235479786, 20.555355395517175, 21.278715139483914, 22.8170128059066, 21.744291316440968, 20.87675557774734, 20.18947900501487, 19.66349440398585], [32.827607915561565, 32.846943521241364, 32.866715646648295, 32.96053714577686, 32.98255380352192, 33.364067830937316, 34.02565922770097, 35.164703050330054, 35.42931477533054, 37.49232564264808, 37.95035673122765, 38.45388929349041, 39.0078821554164, 39.61785975178672, 40.28997934234334, 41.031101801160894, 41.84888160477037, 42.75186479233961, 43.74959409049834, 44.287272744115754, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785, 45.163563664702785], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.014461354190982234, 0.014542063720137902, 0.014632237458510222, 0.014715788447314481, 0.01590815705305469, 0.01597909544333306, 0.01604764909074074, 0.016113644770893176, 0.01617649195385408, 0.016234780272249533, 0.016289788550591888, 0.016342690408929408, 0.016368959819386884, 0.016418730830702194, 0.01663424250326643, 0.016244264883373775, 0.015910502854806368, 0.015632749095449282, 0.015411281253632125], 12496.800000000001)

        high_output_test = TASOPT.odperf!(ac, W[1], FL, Ldebug) 
        
        # Compare scalar values
        @test isapprox(high_output_test[1], high_outputs_correct[1]; atol=1e-6)
        @test isapprox(high_output_test[2], high_outputs_correct[2]; atol=1e-6)

        # Compare vector values
        for i in 1:length(high_outputs_correct[3:end])
            @test isapprox(high_output_test[i+2], high_outputs_correct[i+2]; atol=1e-6)
        end
        
        nom_output_test  = TASOPT.odperf!(ac, W[2], FL, Ldebug) 
        # Compare scalar values
        @test isapprox(nom_output_test[1], nom_outputs_correct[1]; atol=1e-6)
        @test isapprox(nom_output_test[2], nom_outputs_correct[2]; atol=1e-6)

        # Compare vector values
        for i in 1:length(nom_outputs_correct[3:end])
            @test isapprox(nom_output_test[i+2], nom_outputs_correct[i+2]; atol=1e-6)
        end

        low_outputs_test = TASOPT.odperf!(ac, W[3], FL, Ldebug) 
        # Compare scalar values
        @test isapprox(low_outputs_test[1], low_outputs_correct[1]; atol=1e-6)
        @test isapprox(low_outputs_test[2], low_outputs_correct[2]; atol=1e-6)

        # Compare vector values
        for i in 1:length(low_outputs_correct[3:end])
            @test isapprox(low_outputs_test[i+2], low_outputs_correct[i+2]; atol=1e-6)
        end

    end


    @testset "LTO" begin

        file_LTO =joinpath(TASOPT.__TASOPTroot__, "../test/LTO_test.LTO")
        file_LTO_extra_pts =joinpath(TASOPT.__TASOPTroot__, "../test/LTO_extra_pts_test.LTO")

        open("B738__.LTO", "w") do f
            TASOPT.LTO("B738__", ac; fileout = f, method = "quartic")
        end

        content = read(file_LTO, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("B738__.LTO", String)
        rm("B738__.LTO")
        
        open("B738__extra_pts.LTO", "w") do f
            TASOPT.LTO("B738__extra_pts", ac; fileout = f, extra_points = true,method = "quartic")
        end

        content = read(file_LTO_extra_pts, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("B738__extra_pts.LTO", String)
        rm("B738__extra_pts.LTO")

    end

    @testset "PTF" begin
        W0high, h3, V0shigh, desTAShigh, ROChigh, mdotfhigh, crzmdotfhigh, crzTAShigh, EGThigh, FFmaxcrzhigh, ROCmaxhigh , Tt4crzhigh, Tt4crzmaxhigh, crzEINOxhigh, clmbEINOxhigh, crzFARhigh, cruisealthigh = TASOPT.odperf!(ac, W[1], FL, Ldebug) 
        W0nom , h2, V0snom , desTASnom, ROCnom , mdotfnom , crzmdotfnom , crzTASnom , EGTnom , FFmaxcrznom , ROCmaxnom  , Tt4crznom , Tt4crzmaxnom , crzEINOxnom , clmbEINOxnom , crzFARnom, cruisealtnom  = TASOPT.odperf!(ac, W[2], FL, Ldebug) 
        W0lo  , h1, V0slo  , desTASlo, ROClo  , mdotflo  , crzmdotflo  , crzTASlo  , EGTlo  , FFmaxcrzlo  , ROCmaxlo   , Tt4crzlo  , Tt4crzmaxlo  , crzEINOxlo  , clmbEINOxlo  , crzFARlo, cruisealtlo   = TASOPT.odperf!(ac, W[3], FL, Ldebug) 
        
        file_PTF_NOX =joinpath(TASOPT.__TASOPTroot__, "../test/PTF_NOX_test.PTF")
        file_PTF =joinpath(TASOPT.__TASOPTroot__, "../test/PTF_test.PTF")
        

        ptf_file_name = "NOX_B738__.PTF" 
        open(ptf_file_name, "w") do f
            TASOPT.printBADA(f, "B738__", [W0lo, W0nom, W0high], max(cruisealthigh, cruisealtnom, cruisealtlo),
                V0slo./kts_to_mps, desTASlo, hcat(ROClo, ROCnom, ROChigh)', mdotfnom*60,
                hcat(crzmdotflo*60, crzmdotfnom*60, crzmdotfhigh*60)', crzTASlo, FL, Wpaymax; NOx = true, crzNoxEI =hcat(crzEINOxlo,crzEINOxnom,crzEINOxhigh)', ffpminNoxEI=clmbEINOxnom)
        end

        content = read(file_PTF_NOX, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("NOX_B738__.PTF", String)
        rm("NOX_B738__.PTF")

                         
        ptf_file_name = "B738__.PTF"              
        open(ptf_file_name, "w") do f
        # open("B738__.PTF", "w") do f
            TASOPT.printBADA(f, "B738__", [W0lo, W0nom, W0high], max(cruisealthigh, cruisealtnom, cruisealtlo),
            V0slo./kts_to_mps, desTASlo, hcat(ROClo, ROCnom, ROChigh)', mdotfnom*60,
            hcat(crzmdotflo*60, crzmdotfnom*60, crzmdotfhigh*60)', crzTASlo, FL, Wpaymax; NOx = false, crzNoxEI =hcat(crzEINOxlo,crzEINOxnom,crzEINOxhigh)', ffpminNoxEI=clmbEINOxnom)
        end

        content = read(file_PTF, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("B738__.PTF", String)
        rm("B738__.PTF")

    end 
end