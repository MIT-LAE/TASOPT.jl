@testset "performance" verbose=true begin
    ac = load_default_model()
    size_aircraft!(ac; printiter=false);
    FL = float([  0 ,    5 ,   10 ,   15 ,   20 ,   
            30 ,   40 ,   60 ,   80 ,  100 , 
            120 ,  140 ,  160 ,  180 ,  200 ,
            220 ,  240 ,  260 ,  280 ,  290 , 
            310 ,  330 ,  350 ,  370 ,  390 ,
            410])

    parg = ac.parg
    ZFW = parg[igWMTO] - parg[igWfuel]
    OEW = parg[igWMTO] - parg[igWfuel] - parg[igWpay]
            
    M_high = 0.92 * parg[igWMTO]
    M_low = 0.45 * parg[igWMTO] +(0.63 * (parg[igWMTO]^0.924))
    W = [parg[igWMTO], 1/3*(OEW+2*parg[igWMTO]), 1.2*OEW]
    Wpaymax = parg[igWpaymax]
    Ldebug = false

    @testset "off design performance" begin
        high_outputs_correct = (885454.0298898229, 12496.800000000001, [80.81275720164649, 81.39379412431006, 81.98161188263717, 85.20233995064308, 85.82234928001363, 97.80729092781559, 115.54249464124159, 140.08552139650615, 144.25638080841546, 177.77537021190292, 183.0601797378208, 188.5521173101196, 194.25360270400643, 200.1661063467623, 206.2900340467326, 212.62461202148936, 219.16777682424814, 225.91608887758503, 232.86479312886004, 236.41264441866187, 241.43705872286955, 239.359920983201, 237.4846310775805, 236.35362144223177, 236.03584679797737, 235.983685523832], [144.08971775773998, 145.12857265635765, 151.24951930762006, 162.5587648643785, 194.5760978175237, 229.58504471848303, 232.9307613515055, 272.30682178000575, 280.4143939204095, 334.27036197570885, 344.26328208608953, 354.6533091966123, 365.4458194048345, 376.6444562446586, 388.25090879628647, 400.2646880695055, 412.68291006191595, 425.5001205402086, 438.70839420244005, 445.45639573697844, 459.2388851020328, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [2392.5446298213124, 2403.759631238322, 2415.032667568145, 2524.707363105079, 2658.424110146259, 3045.9896256671636, 3141.3401179662983, 3943.9020227148794, 4006.915992010808, 4283.930560080293, 4323.248705022914, 4353.573813794754, 4368.889965822836, 4356.542870952369, 4277.7134718116995, 3372.14220929623, 3412.768218449977, 3453.4307930306522, 3494.3853993482935, 3515.6503952682483, 3558.7635886985254, 3607.2290040683347, 3634.399969806232, 3622.4186539190414, 3514.7023264683207, 3007.568234432213], [1.3617074836848544, 1.3616250825449718, 1.3615408258961443, 1.3611410767164234, 1.3610472825509097, 1.3594224718373513, 1.3566040207047827, 1.3517266241711197, 1.3505841344590053, 1.3413969742155325, 1.3392367515825847, 1.3367685930755384, 1.3338856328818924, 1.330371392915629, 1.325568963038649, 1.3065429659652807, 1.303930741723435, 1.3011156654705407, 1.2980853171747073, 1.2964854852301513, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.075293064987039, 1.0814205096329064, 1.0882888841613247, 1.0948320326704466, 1.1400265170792299, 1.1462654862607462, 1.152484332104817, 1.1587628195791202, 1.1667648454083612, 1.1724666344936145, 1.1780710258721006, 1.183461481598062, 1.1860333256198394, 1.191378996281197, 1.2041974845084062, 1.196185901287262, 1.2025821608929368, 1.2430611503554982, 1.385344947726533], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 272.30682178000575, 280.4143939204095, 288.8726703929836, 297.6912462923113, 342.7558745030535, 353.25127374797063, 364.14805983243093, 375.44878601788986, 387.15394727893124, 399.2617620445512, 411.7679915944973, 424.6660222141039, 431.2595993728225, 444.7353321785322, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3517266241711197, 1.3505841344590053, 1.3493277267020083, 1.3479430113164912, 1.3410148984240475, 1.338737737893265, 1.336120010010158, 1.333030100241866, 1.3291761658956358, 1.3233867112080844, 1.3056995859631426, 1.3029673085268842, 1.3015225977519114, 1.2984682647397137, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3932.18495389805, 3995.436962940208, 4055.4366997534157, 4116.214948084478, 4360.346364018614, 4401.947349355331, 4432.870684111139, 4445.269599367326, 4415.251938041944, 4291.273793715847, 3480.7044136023187, 3523.3381708794277, 3545.119417744765, 3587.5521683605352, 3629.852331898192, 3640.254150563969, 3591.1834582535844, 3386.7278316578063, 2670.727580460864], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1613.3042600499284, 1613.4461465934469, 1613.6018978842912, 1613.7732025007217, 1614.6242904952414, 1614.901617299575, 1615.2187466850767, 1615.5905198340417, 1616.0497008246653, 1616.7272851960943, 1618.7294778727335, 1619.0724919424106, 1619.25375218863, 1619.636719822406, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.17305981458966, 21.733294853403535, 22.37596971810377, 23.045780699421062, 27.55371666667695, 28.524735152438353, 29.570581473711922, 30.704735280048123, 32.07408556389354, 33.35557664172469, 34.734757426118485, 36.21639198673385, 36.99697347056785, 38.68905548788117, 41.840530499434905, 41.00895986878419, 41.67178100710871, 46.06509006657757, 64.1386948767382], [35.390123495033805, 35.4119700678247, 35.434313465759786, 35.540386063609084, 35.56528967026024, 35.99757625332311, 36.750764149387685, 38.05985853891318, 38.36667998785909, 40.80980891777983, 41.370771273512084, 42.000748311573695, 42.71736217406002, 43.55332716691468, 44.599855010064026, 47.49352902916761, 48.41074688894354, 49.41646747612528, 50.519439812061435, 51.110360912890194, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.017760989914835778, 0.017862199051305264, 0.01797564638459763, 0.01808372184650269, 0.01883021487982313, 0.0189332661058749, 0.0190359849477562, 0.01913968891120812, 0.019271861157713885, 0.019366039593097847, 0.019458609276650378, 0.01954764531054903, 0.019590125353637442, 0.01967842165703223, 0.019890149089803914, 0.019757818980528707, 0.01986346822727655, 0.02053207378888311, 0.022882224805789317], 12496.800000000001)

        nom_outputs_correct = (748246.8475410432, 12496.800000000001, [80.81275720164649, 81.39379412431006, 81.98161188263717, 85.20233995064308, 85.82234928001363, 97.80729092781559, 115.54249464124159, 140.08552139650615, 144.25638080841546, 177.77537021190292, 183.0601797378208, 188.5521173101196, 194.25360270400643, 200.1661063467623, 206.2900340467326, 212.62461202148936, 219.16777682424814, 225.91608887758503, 232.86479312886004, 236.41264441866187, 241.43705872286955, 239.359920983201, 237.4846310775805, 236.35362144223177, 236.03584679797737, 235.983685523832], [144.08971775773998, 145.12857265635765, 151.24951930762006, 162.5587648643785, 194.5760978175237, 229.58504471848303, 232.9307613515055, 272.30682178000575, 280.4143939204095, 334.27036197570885, 344.26328208608953, 354.6533091966123, 365.4458194048345, 376.6444562446586, 388.25090879628647, 400.2646880695055, 412.68291006191595, 425.5001205402086, 438.70839420244005, 445.45639573697844, 459.2388851020328, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [3148.1886336122316, 3163.8671108057038, 3179.644644817082, 3300.3619732604284, 3430.4864875387684, 3857.7078183185163, 4343.336540170292, 4858.398329577646, 4939.720440041288, 5228.732345439696, 5282.0468211094085, 5324.97734710128, 5350.399664217185, 5343.540121783397, 5258.929740523697, 4201.261049719896, 4258.515492032673, 4316.703543594969, 4376.74410868505, 4406.085911928048, 4476.037739730821, 4563.649050006226, 4630.62575915986, 4687.256891259354, 4734.145806737335, 4733.3752015877135], [1.3617074836848544, 1.3616250825449718, 1.3615408258961443, 1.3611410767164234, 1.3610472825509097, 1.3594224718373513, 1.3566040207047827, 1.3517266241711197, 1.3505841344590053, 1.3413969742155325, 1.3392367515825847, 1.3367685930755384, 1.3338856328818924, 1.330371392915629, 1.325568963038649, 1.3065429659652807, 1.303930741723435, 1.3011156654705407, 1.2980853171747073, 1.2964854852301513, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0137697506966203, 1.019516040179866, 1.0259815357621105, 1.0320830561184287, 1.0902861423324748, 1.096107036535312, 1.101881863853603, 1.1076661688078808, 1.1151435949547865, 1.1201557432804043, 1.1249171282794788, 1.129542377393752, 1.131842063052265, 1.1362856627677855, 1.14870639212717, 1.132684697544569, 1.1207503809788542, 1.1155143195210748, 1.125198715936891], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 272.30682178000575, 280.4143939204095, 288.8726703929836, 297.6912462923113, 342.7558745030535, 353.25127374797063, 364.14805983243093, 375.44878601788986, 387.15394727893124, 399.2617620445512, 411.7679915944973, 424.6660222141039, 431.2595993728225, 444.7353321785322, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3517266241711197, 1.3505841344590053, 1.3493277267020083, 1.3479430113164912, 1.3410148984240475, 1.338737737893265, 1.336120010010158, 1.333030100241866, 1.3291761658956358, 1.3233867112080844, 1.3056995859631426, 1.3029673085268842, 1.3015225977519114, 1.2984682647397137, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4856.291719690294, 4938.334767532359, 5016.666158471327, 5096.344232494006, 5366.817411613711, 5423.886942955981, 5468.85535169525, 5492.614021396976, 5467.119776163045, 5331.7766583185685, 4387.3577185248605, 4449.958127278729, 4481.481159645528, 4545.595798511051, 4613.039914601128, 4666.575740736435, 4710.11373176582, 4732.015087142608, 4676.561618569959], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1613.3042600499284, 1613.4461465934469, 1613.6018978842912, 1613.7732025007217, 1614.6242904952414, 1614.901617299575, 1615.2187466850767, 1615.5905198340417, 1616.0497008246653, 1616.7272851960943, 1618.7294778727335, 1619.0724919424106, 1619.25375218863, 1619.636719822406, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.1404940723559, 18.581641710527904, 19.090127623501154, 19.620027122923037, 24.182318591953074, 25.00622608853308, 25.89520561510361, 26.859531834760254, 28.029670097915627, 29.111861427148504, 30.26855147304578, 31.51611554591006, 32.18218329234982, 33.60011132626438, 36.3578706523652, 34.89503044393316, 33.84025122731421, 33.38685647095592, 34.229928243881815], [35.390123495033805, 35.4119700678247, 35.434313465759786, 35.540386063609084, 35.56528967026024, 35.99757625332311, 36.750764149387685, 38.05985853891318, 38.36667998785909, 40.80980891777983, 41.370771273512084, 42.000748311573695, 42.71736217406002, 43.55332716691468, 44.599855010064026, 47.49352902916761, 48.41074688894354, 49.41646747612528, 50.519439812061435, 51.110360912890194, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01674478791352131, 0.016839701377471608, 0.016946494218948775, 0.017047275154902303, 0.01800863579315068, 0.01810478152922791, 0.018200166362535023, 0.018295707741255343, 0.01841921499216998, 0.01850200239103043, 0.018580647844723776, 0.018657044694612508, 0.018695029403263664, 0.01876842588679244, 0.018973583397865566, 0.018708947490534027, 0.018511824228917274, 0.018425338378898145, 0.018585298926095253], 12496.800000000001)

        low_outputs_correct = (568598.9794121803, 12496.800000000001, [80.81275720164649, 81.39379412431006, 81.98161188263717, 85.20233995064308, 85.82234928001363, 97.80729092781559, 115.54249464124159, 140.08552139650615, 144.25638080841546, 177.77537021190292, 183.0601797378208, 188.5521173101196, 194.25360270400643, 200.1661063467623, 206.2900340467326, 212.62461202148936, 219.16777682424814, 225.91608887758503, 232.86479312886004, 236.41264441866187, 241.43705872286955, 239.359920983201, 237.4846310775805, 236.35362144223177, 236.03584679797737, 235.983685523832], [144.08971775773998, 145.12857265635765, 151.24951930762006, 162.5587648643785, 194.5760978175237, 229.58504471848303, 232.9307613515055, 272.30682178000575, 280.4143939204095, 334.27036197570885, 344.26328208608953, 354.6533091966123, 365.4458194048345, 376.6444562446586, 388.25090879628647, 400.2646880695055, 412.68291006191595, 425.5001205402086, 438.70839420244005, 445.45639573697844, 459.2388851020328, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [3991.085390973837, 4005.8339150118345, 4020.521973089936, 4500.677234548714, 4586.281660136895, 5384.091299170535, 6014.478647205702, 6636.862963877525, 6752.699889600856, 6529.45776210079, 6624.270378742943, 6709.567445153357, 6776.791980220443, 6807.693435847972, 6745.853119069337, 5481.832614859439, 5595.752900090737, 5714.574221696124, 5833.445759811901, 5894.630835011689, 6075.706683041074, 6343.423409249392, 6505.048728849178, 6631.2790925056825, 6755.151815442907, 6863.134284248552], [1.3617074836848544, 1.3616250825449718, 1.3615408258961443, 1.3611410767164234, 1.3610472825509097, 1.3594224718373513, 1.3566040207047827, 1.3517266241711197, 1.3505841344590053, 1.3413969742155325, 1.3392367515825847, 1.3367685930755384, 1.3338856328818924, 1.330371392915629, 1.325568963038649, 1.3065429659652807, 1.303930741723435, 1.3011156654705407, 1.2980853171747073, 1.2964854852301513, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.946756866521352, 0.952101179298477, 0.9581313978642566, 0.9637423688180806, 1.0386886220634803, 1.0436413890845604, 1.0485375935258419, 1.0534331307605027, 1.060061666774662, 1.0641354057679506, 1.0679573900953845, 1.071612397176973, 1.0734095970581874, 1.076803893239715, 1.0903842652065858, 1.066985866639931, 1.046998751257904, 1.0304455323377295, 1.0172806330836992], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 272.30682178000575, 280.4143939204095, 288.8726703929836, 297.6912462923113, 342.7558745030535, 353.25127374797063, 364.14805983243093, 375.44878601788986, 387.15394727893124, 399.2617620445512, 411.7679915944973, 424.6660222141039, 431.2595993728225, 444.7353321785322, 465.2824838332964, 461.63718038562416, 459.4386545413105, 458.82094471265333, 458.7195504312106], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335, 0.0033333333333333335], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.3517266241711197, 1.3505841344590053, 1.3493277267020083, 1.3479430113164912, 1.3410148984240475, 1.338737737893265, 1.336120010010158, 1.333030100241866, 1.3291761658956358, 1.3233867112080844, 1.3056995859631426, 1.3029673085268842, 1.3015225977519114, 1.2984682647397137, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542, 1.2939257300386542], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6650.137918473924, 6768.133893728956, 6881.144506890539, 6996.55105604875, 7319.980581881774, 7407.877552633637, 7480.711873839703, 7526.646928401953, 7509.155819039738, 7349.100719687392, 6132.20991657432, 6231.825071149949, 6282.414295396054, 6386.124984580741, 6487.729732625356, 6602.260031393795, 6709.112988458661, 6812.7425185491675, 6899.620469749677], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1613.3042600499284, 1613.4461465934469, 1613.6018978842912, 1613.7732025007217, 1614.6242904952414, 1614.901617299575, 1615.2187466850767, 1615.5905198340417, 1616.0497008246653, 1616.7272851960943, 1618.7294778727335, 1619.0724919424106, 1619.25375218863, 1619.636719822406, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613, 1620.2057001576613], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.502642199066536, 15.834545642412971, 16.21863923827222, 16.61832888849697, 21.161545701769914, 21.82373920376473, 22.540686796841364, 23.321307650231155, 24.280838012618887, 25.15929633127615, 26.101401788285447, 27.11899927256669, 27.66063026827442, 28.807983401406098, 31.290048664704912, 29.45430376415772, 27.973425263127048, 26.80642194528224, 25.915950456288325], [35.390123495033805, 35.4119700678247, 35.434313465759786, 35.540386063609084, 35.56528967026024, 35.99757625332311, 36.750764149387685, 38.05985853891318, 38.36667998785909, 40.80980891777983, 41.370771273512084, 42.000748311573695, 42.71736217406002, 43.55332716691468, 44.599855010064026, 47.49352902916761, 48.41074688894354, 49.41646747612528, 50.519439812061435, 51.110360912890194, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584, 52.068393894894584], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0156379127752395, 0.015726186649987674, 0.015825789869443347, 0.015918468230132397, 0.017156381587327088, 0.017238188164507045, 0.017319060477864353, 0.017399921770737625, 0.01750940760779083, 0.017576694973004462, 0.01763982401875445, 0.017700195043202128, 0.017729880019330544, 0.0177859447910761, 0.018010256522823592, 0.0176237770276074, 0.01729364288438095, 0.01702022760451691, 0.016802778380213136], 12496.800000000001)
        high_output_test = TASOPT.odperf!(ac, W[1], FL, Ldebug) 
        
        # Compare scalar values
        @test isapprox(high_output_test[1], high_outputs_correct[1]; atol=1e-6)
        @test isapprox(high_output_test[2], high_outputs_correct[2]; atol=1e-6)

        # Compare vector values
        for i in 1:length(high_outputs_correct[3:end])
            @test isapprox(high_output_test[i+2], high_outputs_correct[i+2]; atol=1e-6)
        end
        
        nom_output_test  = TASOPT.odperf!(ac, W[2], FL, Ldebug) 
        # Compare scalar values
        @test isapprox(nom_output_test[1], nom_outputs_correct[1]; atol=1e-6)
        @test isapprox(nom_output_test[2], nom_outputs_correct[2]; atol=1e-6)

        # Compare vector values
        for i in 1:length(nom_outputs_correct[3:end])
            @test isapprox(nom_output_test[i+2], nom_outputs_correct[i+2]; atol=1e-6)
        end

        low_outputs_test = TASOPT.odperf!(ac, W[3], FL, Ldebug) 
        # Compare scalar values
        @test isapprox(low_outputs_test[1], low_outputs_correct[1]; atol=1e-6)
        @test isapprox(low_outputs_test[2], low_outputs_correct[2]; atol=1e-6)

        # Compare vector values
        for i in 1:length(low_outputs_correct[3:end])
            @test isapprox(low_outputs_test[i+2], low_outputs_correct[i+2]; atol=1e-6)
        end

    end


    @testset "LTO" begin

        file_LTO =joinpath(TASOPT.__TASOPTroot__, "../test/LTO_test.LTO")
        file_LTO_extra_pts =joinpath(TASOPT.__TASOPTroot__, "../test/LTO_extra_pts_test.LTO")

        open("B738__.LTO", "w") do f
            TASOPT.output_LTO_perf("B738__", ac; fileout = f, method = "quartic")
        end

        content = read(file_LTO, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("B738__.LTO", String)
        rm("B738__.LTO")
        
        open("B738__extra_pts.LTO", "w") do f
            TASOPT.output_LTO_perf("B738__extra_pts", ac; fileout = f, extra_points = true,method = "quartic")
        end

        content = read(file_LTO_extra_pts, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("B738__extra_pts.LTO", String)
        rm("B738__extra_pts.LTO")

    end

    @testset "PTF" begin
        W0high, h3, V0shigh, desTAShigh, ROChigh, mdotfhigh, crzmdotfhigh, crzTAShigh, EGThigh, FFmaxcrzhigh, ROCmaxhigh , Tt4crzhigh, Tt4crzmaxhigh, crzEINOxhigh, clmbEINOxhigh, crzFARhigh, cruisealthigh = TASOPT.odperf!(ac, W[1], FL, Ldebug) 
        W0nom , h2, V0snom , desTASnom, ROCnom , mdotfnom , crzmdotfnom , crzTASnom , EGTnom , FFmaxcrznom , ROCmaxnom  , Tt4crznom , Tt4crzmaxnom , crzEINOxnom , clmbEINOxnom , crzFARnom, cruisealtnom  = TASOPT.odperf!(ac, W[2], FL, Ldebug) 
        W0lo  , h1, V0slo  , desTASlo, ROClo  , mdotflo  , crzmdotflo  , crzTASlo  , EGTlo  , FFmaxcrzlo  , ROCmaxlo   , Tt4crzlo  , Tt4crzmaxlo  , crzEINOxlo  , clmbEINOxlo  , crzFARlo, cruisealtlo   = TASOPT.odperf!(ac, W[3], FL, Ldebug) 
        
        file_PTF_NOX =joinpath(TASOPT.__TASOPTroot__, "../test/PTF_NOX_test.PTF")
        file_PTF =joinpath(TASOPT.__TASOPTroot__, "../test/PTF_test.PTF")
        

        ptf_file_name = "NOX_B738__.PTF" 
        open(ptf_file_name, "w") do f
            TASOPT.output_BADA(f, "B738__", [W0lo, W0nom, W0high], max(cruisealthigh, cruisealtnom, cruisealtlo),
                V0slo./kts_to_mps, desTASlo, hcat(ROClo, ROCnom, ROChigh)', mdotfnom*60,
                hcat(crzmdotflo*60, crzmdotfnom*60, crzmdotfhigh*60)', crzTASlo, FL, Wpaymax; NOx = true, crzNoxEI =hcat(crzEINOxlo,crzEINOxnom,crzEINOxhigh)', ffpminNoxEI=clmbEINOxnom)
        end

        content = read(file_PTF_NOX, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("NOX_B738__.PTF", String)
        rm("NOX_B738__.PTF")

                         
        ptf_file_name = "B738__.PTF"              
        open(ptf_file_name, "w") do f
        # open("B738__.PTF", "w") do f
            TASOPT.output_BADA(f, "B738__", [W0lo, W0nom, W0high], max(cruisealthigh, cruisealtnom, cruisealtlo),
            V0slo./kts_to_mps, desTASlo, hcat(ROClo, ROCnom, ROChigh)', mdotfnom*60,
            hcat(crzmdotflo*60, crzmdotfnom*60, crzmdotfhigh*60)', crzTASlo, FL, Wpaymax; NOx = false, crzNoxEI =hcat(crzEINOxlo,crzEINOxnom,crzEINOxhigh)', ffpminNoxEI=clmbEINOxnom)
        end

        content = read(file_PTF, String)
        content = replace(content, "\r\n"=> "\n") # Convert \r\n to \n
        @test content == read("B738__.PTF", String)
        rm("B738__.PTF")

    end 
end