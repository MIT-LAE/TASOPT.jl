<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Drag ¬∑ TASOPT.jl</title><meta name="title" content="Drag ¬∑ TASOPT.jl"/><meta property="og:title" content="Drag ¬∑ TASOPT.jl"/><meta property="twitter:title" content="Drag ¬∑ TASOPT.jl"/><meta name="description" content="Documentation for TASOPT.jl."/><meta property="og:description" content="Documentation for TASOPT.jl."/><meta property="twitter:description" content="Documentation for TASOPT.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TASOPT.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/loadingrunning/">Loading and running</a></li><li><a class="tocitem" href="../../examples/payload_range/">Payload-range diagram</a></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/NM_optimization/">Nelder Mead</a></li><li><a class="tocitem" href="../../examples/gradient_based_optimization/">Gradient Based Optimization</a></li></ul></li><li><a class="tocitem" href="../../examples/sensitivity/">Sensitivities</a></li></ul></li><li><span class="tocitem">Aerodynamics</span><ul><li><a class="tocitem" href="../aerosummary/">Summary and outputs</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li><a class="tocitem" href="../lift/">Lift</a></li><li class="is-active"><a class="tocitem" href>Drag</a><ul class="internal"><li><a class="tocitem" href="#axi"><span>Axisymmetric fuselage drag</span></a></li><li><a class="tocitem" href="#trefftz"><span>Trefftz plane drag calculation</span></a></li><li><a class="tocitem" href="#Wing-and-tail-surfaces"><span>Wing and tail surfaces</span></a></li><li><a class="tocitem" href="#Total-drag-calculation"><span>Total drag calculation</span></a></li><li><a class="tocitem" href="#Other-utilities"><span>Other utilities</span></a></li></ul></li><li><a class="tocitem" href="../moment/">Pitching moment</a></li><li><a class="tocitem" href="../../atmos/atmos/">Atmospheric properties</a></li></ul></li><li><span class="tocitem">Structures</span><ul><li><a class="tocitem" href="../../structures/wing/">Wings and tails</a></li><li><a class="tocitem" href="../../structures/fuselage/">Fuselage</a></li><li><a class="tocitem" href="../../structures/landing_gear/">Landing gear</a></li><li><a class="tocitem" href="../../structures/cabin_sizing/">Cabin sizing</a></li></ul></li><li><span class="tocitem">Propulsion systems</span><ul><li><a class="tocitem" href="../../propulsion/propsys/">Propulsion system</a></li><li><a class="tocitem" href="../../propulsion/gascalc/">Gas Calculations</a></li><li><a class="tocitem" href="../../propulsion/hxfun/">Heat exchangers</a></li><li><a class="tocitem" href="../../propulsion/PEMfuelcell/">PEM fuel cells</a></li><li><a class="tocitem" href="../../propulsion/ElectricMachines/">Electric Machines</a></li></ul></li><li><span class="tocitem">Cryogenic tanks</span><ul><li><a class="tocitem" href="../../cryo_tank/fueltanks/">Thermal and structural models</a></li><li><a class="tocitem" href="../../cryo_tank/cryotank/">Homogeneous model</a></li></ul></li><li><a class="tocitem" href="../../balance/balance/">Stability</a></li><li><span class="tocitem">Mission and sizing</span><ul><li><a class="tocitem" href="../../sizing/sizing/">Design and evaluation</a></li><li><a class="tocitem" href="../../sizing/weightmodels/">TASOPT Weight Model</a></li></ul></li><li><span class="tocitem">Data and I/O</span><ul><li><a class="tocitem" href="../../data_io/data_basics/">Data structure basics</a></li><li><a class="tocitem" href="../../data_io/structs/">Data structure details</a></li><li><a class="tocitem" href="../../data_io/data_io/">Loading and saving models</a></li></ul></li><li><span class="tocitem">Miscellaneous</span><ul><li><a class="tocitem" href="../../misc/dreladocs/">Original Drela docs</a></li><li><a class="tocitem" href="../../misc/fordevs/">Notes for devs</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Aerodynamics</a></li><li class="is-active"><a href>Drag</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Drag</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MIT-LAE/TASOPT.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MIT-LAE/TASOPT.jl/blob/main/docs/src/aero/drag.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Drag"><a class="docs-heading-anchor" href="#Drag">Drag</a><a id="Drag-1"></a><a class="docs-heading-anchor-permalink" href="#Drag" title="Permalink"></a></h1><p>The key drag contributions are assumed to come from the fuselage, wing, and tail surfaces, and the lift-induced drag calculated at the Trefftz plane. Wave drag is not explicitly modelled.</p><h2 id="axi"><a class="docs-heading-anchor" href="#axi">Axisymmetric fuselage drag</a><a id="axi-1"></a><a class="docs-heading-anchor-permalink" href="#axi" title="Permalink"></a></h2><p>The fuselage profile drag is determined by a quasi-axisymmetric coupled viscous-inviscid calculation. See <a href="../../assets/drela_TASOPT_2p16/axibl.pdf">Simplified Viscous/Inviscid Analysis for Nearly-Axisymmetric Bodies</a> by M. Drela.</p><p>This method does not require any wetted area approximations or fineness-ratio correlations, but does require the geometry to be specified in the form of a cross-sectional area distribution <span>$A{\scriptstyle (x)}$</span> and a perimeter distribution <span>$b_0{\scriptstyle (x)}$</span>, shown in the Figure¬†below. For a round cross-section these are, of course, related. To allow treating more general fuselage cross-sections, they are assumed to be specified separately. The cross section sizes and shapes can vary along the body, provided the variation is reasonably smooth.</p><p><img src="../../assets/ADfuse.png" alt="ADfuse"/></p><details class="admonition is-details" id="Theory-axisymmetric-fuselage-profile-drag-547958dcd634cffd"><summary class="admonition-header">üìñ Theory - axisymmetric fuselage profile drag<a class="admonition-anchor" href="#Theory-axisymmetric-fuselage-profile-drag-547958dcd634cffd" title="Permalink"></a></summary><div class="admonition-body"><p>The viscous calculation produces displacement, momentum, and kinetic energy areas <span>$\Delta^*, \Theta, \Theta^* {\scriptstyle (x)}$</span>.</p><p>The cross-sectional area over the center cylindrical portion is <span>$A_{\rm fuse}$</span>, which has already been defined by</p><p class="math-container">\[\begin{aligned}
A_{\rm fuse} =  \left[ \pi + n_{\rm fweb}\left( 2\theta_{\rm fb}+ \sin 2 \theta_{\rm fb}\right) 
 \right] R_{\rm fuse}^2 \;+\; 2 \left[ R_{\rm fuse}+ n_{\rm fweb}w_{\rm fb}\right] \Delta R_{\rm fuse}.
\end{aligned}\]</p><p>This also defines the radius of the equivalent round cylinder.  <span>$\begin{aligned} R_{\rm cyl}&amp; = &amp; \sqrt{\frac{A_{\rm fuse}}{\pi}} \end{aligned}.$</span> </p><p>The equivalent radii over the tapering nose and radius are then defined via the following convenient functions.</p><p class="math-container">\[\begin{aligned}
R {\scriptstyle (x)}&amp; = &amp;
\left\{
\begin{array}{lcl}
\displaystyle
R_{\rm cyl}
\left[ \: 
1 - \left( \frac{x_{{\rm blend}_1} \!-\! x}{x_{{\rm blend}_1} \!-\! x_{\rm nose}} 
      \right)^{\!\! a} \;
      \right]^{\! 1/a}
&amp; , &amp; x_{\rm nose}&lt; x &lt; x_{{\rm blend}_1} 
\\[1.0em]
\displaystyle
R_{\rm cyl}
&amp; , &amp; x_{{\rm blend}_1} &lt; x &lt; x_{{\rm blend}_{\,2}}
\\[0.5em]
\displaystyle
R_{\rm cyl}
\left[ \:
1 - \left( \frac{x \!-\! x_{{\rm blend}_{\,2}}}{x_{\rm end} \!-\! x_{{\rm blend}_{\,    2}}} 
      \right)^{\!\! b} \;
      \right]
&amp; , &amp; x_{{\rm blend}_{\,2}} &lt; x &lt; x_{\rm tail}
\end{array}
\right.
\\
a &amp; \simeq 1.6 &amp;
\\
b &amp; \simeq 2.0 &amp;
\end{aligned}\]</p><p>The <span>$x_{{\rm blend}_1}$</span> and <span>$x_{{\rm blend}_{\,2}}$</span> locations are the nose and tailcone blend points, and do not necessarily have to be exactly the same as the <span>$x_{{\rm shell}_1}$</span> and <span>$x_{{\rm shell}_{\,2}}$</span> locations which define the loaded pressure shell. Likewise, <span>$x_{\rm end}$</span> is the aerodynamic endpoint of the tailcone, and is distinct from its structural endpoint <span>$x_{\rm conend}$</span>. The <span>$a$</span> and <span>$b$</span> constant values above give reasonable typical fuselage shapes.</p><p>If the fuselage is nearly round, the necessary area and perimeter distributions follow immediately. </p><p class="math-container">\[\begin{aligned}
A {\scriptstyle (x)}&amp; = &amp; \pi \, {R{\scriptstyle (x)}}^2
\\
b_0 {\scriptstyle (x)}&amp; = &amp; 2 \pi R {\scriptstyle (x)}
\end{aligned}\]</p><p>This would be suitably modified for non-circular cross-sections.</p><p>With this geometry definition, the viscous/inviscid calculation procedure provides the momentum and kinetic energy area distributions along the body and wake,</p><p class="math-container">\[\begin{aligned}
\left\{ \Theta {\scriptstyle (s)}\, , \: \Theta^* {\scriptstyle (s)}\right\} &amp; = &amp;
f_{\rm f_{excr}} \:
{\cal F}(M_{{\scriptscriptstyle \infty}}, Re_\ell\, ; \, A {\scriptstyle (x)}, b_0 {\scriptstyle (x)})
\end{aligned}\]</p><p>where <span>${\cal F}$</span> denotes the overall viscous/inviscid calculation procedure, and <span>$f_{\rm f_{excr}} \geq 1$</span> is an empirical factor to allow for fuselage excrescence drag sources.</p><p>Specific values of interest are the momentum area <span>$\Theta_{\rm wake}$</span> at the wake numerical endpoint <span>$s_{\rm wake}$</span>, the far-downstream momentum area <span>$\Theta_{\scriptscriptstyle \infty}$</span>, and the kinetic energy area <span>$\Theta_{\scriptscriptstyle T\!E}$</span> at the body endpoint or trailing edge. </p><p class="math-container">\[\begin{aligned}
\Theta_{\rm wake}&amp; = &amp; \Theta (s_{\rm wake}) 
\\
H_{\rm avg}  &amp; = &amp; 
{\textstyle \frac{1}{2}}\left[ H(s_{\rm wake}) + 1 + (\gamma\!-\!1) M_{{\scriptscriptstyle \infty}}^2 \right]
\\
\Theta_{\scriptscriptstyle \infty}&amp; = &amp; \Theta_{\rm wake}
\left( \frac{u_e (s_{\rm wake})}{V_{\!{\scriptscriptstyle \infty}}} \right)^{H_{\rm avg}} 
\\
\Theta^*_{\scriptscriptstyle T\!E}&amp; = &amp; \Theta^*(s_{\scriptscriptstyle T\!E}) 
\end{aligned}\]</p><p>The equation above is the Squire-Young formula, with <span>$H_{\rm avg}$</span> being the average shape parameter between the end of the wake and far downstream.</p><p>The fuselage surface + wake dissipated power in the absence of BLI is then evaluated as follows, consistent with the usual wake momentum defect relations. </p><p class="math-container">\[\begin{aligned}
C&#39;_{\!D_{\rm fuse}} &amp; \equiv &amp;
\frac{\Phi_{\rm surf}-P_{V_{\rm surf}} + \Phi_{\rm wake}-P_{V_{\rm wake}}}
           {{\textstyle \frac{1}{2}}\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}^3 S} 
\hspace{6ex}
\rm{(without BLI)}
\hspace{-9.0ex}
\\
C&#39;_{\!D_{\rm fuse}}
&amp; = &amp; \frac{D_{\rm fuse}}{{\textstyle \frac{1}{2}}\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}^2 S}
\;=\; \frac{2 \Theta_{\scriptscriptstyle \infty}}{S} 
\hspace{17ex}
\rm{(without BLI)}
\hspace{-9.0ex}
\end{aligned}\]</p><p>If BLI is present at or near the trailing edge, the upstream boundary layer and corresponding surface dissipation <span>$\Phi_{\rm surf}$</span> will be mostly unaffected. But the viscous fluid flowing into the wake is now reduced by the ingestion fraction <span>${f_{\rm {\scriptscriptstyle BLI}_{\scriptstyle \,f}}}$</span>, so that the wake dissipation <span>$\Phi_{\rm wake}$</span> will be reduced by the same fraction. This then gives the following overall fuselage dissipation coefficient for the BLI case. </p><p class="math-container">\[\begin{aligned}
C_{\!D_{\rm fuse}} &amp;\!=\! &amp;
\frac{\Phi_{\rm surf}\!-\!P_{V_{\rm surf}} \,+\, 
       (\Phi_{\rm wake}\!-\!P_{V_{\rm wake}})(1\!-\!{f_{\rm {\scriptscriptstyle BLI}_{\scriptstyle \,f}}})}
     {{\textstyle \frac{1}{2}}\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}^3 S} 
\hspace{3ex}
\mathrm{(with BLI)}
\hspace{-2ex}
\\
C_{\!D_{\rm fuse}} 
&amp; \!\simeq\! &amp;
C_{\!D_{\rm fuse}} \,-\, C_{\Phi_{\rm wake}} {f_{\rm {\scriptscriptstyle BLI}_{\scriptstyle \,f}}}
\hspace{23ex}
\mathrm{(with BLI)}
\hspace{-2ex}
\\[0.5em]
\rm{where} \hspace{3ex}
C_{\Phi_{\rm wake}} &amp; \!=\! &amp; 
\frac{2 \Theta_{\scriptscriptstyle \infty}}{S} \:-\: \frac{\Theta^*_{\scriptscriptstyle T\!E}}{S} 
\end{aligned}\]</p></div></details><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics._axisymm_flow-NTuple{16, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics._axisymm_flow-NTuple{16, Any}"><code>TASOPT.aerodynamics._axisymm_flow</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_axisymm_flow(xnose, xend, xblend1, xblend2, Amax, 
      anose, btail, iclose,
      Mach, nc, nldim,
        xl, zl, sl, dyl, ql)</code></pre><p>Calculates compressible potential flow about a quasi-axisymmetric body,  using a simple piecewise-constant source line. Formerly, <code>axisol!()</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-d29cfa6032407cd8"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-d29cfa6032407cd8" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>xnose::Float64</code>: X (axial) location of nose point. </li><li><code>xend::Float64</code>: X location of tail point.</li><li><code>xblend1::Float64</code>: X location of nose-section blend point.</li><li><code>xblend2::Float64</code>: X location of tail-section blend point.</li><li><code>Amax::Float64</code>: Maximum cross-sectional area.</li><li><code>anose::Float64</code>: Nose-section shape exponent.</li><li><code>btail::Float64</code>: Tail-section shape exponent.</li><li><code>iclose::Integer</code>: If 0, tail tapers to a point, otherwise to an edge.</li><li><code>Mach::Float64</code>: Freestream Mach number for Prandtl-Glauert.</li><li><code>nc::Integer</code>: Number of control points to be used.</li><li><code>nldim::Integer</code>: Max dimension of passed arrays.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>nl::Integer</code>: Number of output surface and wake points.</li><li><code>ilte::Integer</code>: Index of TE point.</li><li><code>xl::Array{Float64}</code>: X (axial) locations of surface segment endpoints.</li><li><code>zl::Array{Float64}</code>: Z (vertical) locations of surface segment endpoints.</li><li><code>sl::Array{Float64}</code>: Arc lengths along surface and wake.</li><li><code>dyl::Array{Float64}</code>: Half-width of edge-type tail section.</li><li><code>ql::Array{Float64}</code>: Velocities V/V_inf along surface and wake.</li></ul></div></details><p>See <a href="#axi">theory above</a> or Section 3 of <a href="../../assets/drela_TASOPT_2p16/axibl.pdf">Simplified Viscous/Inviscid Analysis for Nearly-Axisymmetric Bodies</a>.  See also <a href="../../sizing/sizing/#TASOPT.aerodynamics.fuselage_drag!"><code>fuselage_drag!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/axisymm_flow.jl#L1-L35">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics._BL_station_system-NTuple{65, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics._BL_station_system-NTuple{65, Any}"><code>TASOPT.aerodynamics._BL_station_system</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_BL_station_system(is_selfsimilar, is_laminar, is_wake, solves_direct, Mach, uinv, hksep,
      x, b, rn, th, ds, ue,
      h , h_th, h_ds,
      hk, hk_th, hk_ds, hk_ue,
      hc, hc_th, hc_ds, hc_ue,
      hs, hs_th, hs_ds, hs_ue,
      cf, cf_th, cf_ds, cf_ue,
      di, di_th, di_ds, di_ue,
      xm,bm,rnm,thm,dsm,uem, 
      hm , hm_thm, hm_dsm,
      hkm, hkm_thm, hkm_dsm, hkm_uem,
      hcm, hcm_thm, hcm_dsm, hcm_uem,
      hsm, hsm_thm, hsm_dsm, hsm_uem,
      cfm, cfm_thm, cfm_dsm, cfm_uem,
      dim, dim_thm, dim_dsm, dim_uem)</code></pre><p>Computes Jacobian matrices for BL solution at an axial station. Called repeatedly by <a href="#TASOPT.aerodynamics._axisymm_BL-NTuple{10, Any}"><code>_axisymm_BL</code></a>. Formerly, <code>blsys!()</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-2a51e866967d1b2b"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-2a51e866967d1b2b" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>is_selfsimilar::Bool</code>: Self-similar BL profile flag.</li><li><code>is_laminar::Bool</code>: Laminar flow flag.</li><li><code>is_wake::Bool</code>: In wake? Flag.</li><li><code>solves_direct::Bool</code>: Direct solution flag, with prescribed inviscid velocity <span>$u_e = u_\mathrm{inv}$</span></li><li><code>Mach::Float64</code>: Mach number for compressibility.</li><li><code>uinv::Float64</code>: Inviscid velocity.</li><li><code>x::Float64</code>: Arc length.</li><li><code>b::Float64</code>: Lateral width of BL.</li><li><code>rn::Float64</code>: <span>$dr/dn$</span>, <span>$= 0$</span> for 2D.</li><li><code>th::Float64</code>: Momentum thickness.</li><li><code>ds::Float64</code>: Displacement thickness.</li><li><code>ue::Float64</code>: Edge velocity.</li><li><code>h::Float64</code>: Shape parameter.</li><li><code>hk::Float64</code>: Kinematic shape parameter.</li><li><code>hc::Float64</code>: density shape parameter (Whitfield).</li><li><code>hs::Float64</code>: kinetic energy shape parameter.</li><li><code>cf::Float64</code>: Skin friction factor.</li><li><code>di::Float64</code>: Dissipation factor.</li></ul><p><code>m</code> denotes the previous point (minus one) in the upstream.   <code>_z</code> denotes partial derivative with respect to <code>z</code> (<code>z</code> = <code>th</code>, <code>ds</code>, <code>ue</code>).</p><p><strong>Outputs:</strong></p><ul><li><code>aa::Array{Float64, 3, 3}</code>: Jacobian matrix (wrt current point vars).</li><li><code>bb::Array{Float64, 3, 3}</code>: Jacobian matrix (wrt previous point vars).</li><li><code>rr::Array{Float64, 3}</code>: Residual.</li></ul></div></details><p>See Section 4 of <a href="../../assets/drela_TASOPT_2p16/axibl.pdf">Simplified Viscous/Inviscid Analysis for Nearly-Axisymmetric Bodies</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/BL_station_system.jl#L3-L52">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics._axisymm_BL-NTuple{10, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics._axisymm_BL-NTuple{10, Any}"><code>TASOPT.aerodynamics._axisymm_BL</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_axisymm_BL(ndim, n,ite, xi, bi, rni, uinv, Reyn, Mach, fexcr)</code></pre><p>Axisymmetric boundary layer + wake calculation routine. Uses specified inviscid velocity, corrects for viscous displacement to allow calculation of separated flow. Formerly, <code>blax!()</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-f0cac78349ac295d"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-f0cac78349ac295d" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>ndim::Integer</code>: physical array dimension.</li><li><code>n::Integer</code>: number of boundary layer + wake points.</li><li><code>ite::Integer</code>: index of trailing edge point, start of wake.</li><li><code>xi::Array{Float64}</code>: arc length array (BL coordinate).</li><li><code>bi::Array{Float64}</code>: lateral width of BL at surface (i.e., body perimeter). <span>$b_i$</span> = 0 for wake, 1 for 2D.</li><li><code>rni::Array{Float64}</code>: <span>$dr/dn$</span> to account for near-axisymmetric bodies, 0 for 2D.</li><li><code>uinv::Array{Float64}</code>: inviscid velocity, <span>$u_{inv}$</span>.</li><li><code>Reyn::Float64</code>: Reynolds number,  <span>$\rho_{ref} u_{ref} l_{ref} / \mu_{ref}$</span>.</li><li><code>Mach::Float64</code>: Mach number,  <span>$M = u_{ref} / a_{ref}$</span>.</li><li><code>fexcr::Float64</code>: excrescence multiplier applied to wall <span>$c_f$</span>, 1 for smooth wall.</li></ul><p>Assumed units for all quantities:</p><ul><li><code>l_ref</code>: same unit as used for input <code>xi</code>,<code>bi</code>.</li><li><code>u_ref</code>: freestream velocity.</li><li><code>a_ref</code>: freestream speed of sound.</li><li><code>rho_ref</code>: freestream density.</li><li><code>mu_ref</code>: freestream viscosity.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>uei::Array{Float64}</code>:  edge velocity, (<span>$u_{e,i} = u_{inv,i} +$</span> {displacement correction}).</li><li><code>dsi::Array{Float64}</code>:  displacement thickness (<span>$\delta^*$</span>).</li><li><code>thi::Array{Float64}</code>:  momentum thickness     (<span>$\theta$</span>).</li><li><code>tsi::Array{Float64}</code>:  kinetic energy thickness (<span>$\theta^*$</span>).</li><li><code>dci::Array{Float64}</code>:  density flux thickness   (<span>$\delta^{**}$</span>).</li><li><code>cfi::Array{Float64}</code>:  skin friction coefficient, normalized with local <span>$\rho$</span>, <span>$u$</span> (<span>$c_{f,i}$</span>).</li><li><code>cdi::Array{Float64}</code>:  dissipation coefficient  , normalized with local <span>$\rho$</span>,<span>$u$</span> (<span>$c_{\mathcal{D},i}$</span>).</li><li><code>cti::Array{Float64}</code>:  max shear-stress coefficient, normalized with local <span>$\rho$</span>,<span>$u$</span> (<span>$c_{t,i}$</span>).</li><li><code>hki::Array{Float64}</code>:  kinematic shape parameter (<span>$H_{K,i}$</span>).</li><li><code>phi::Array{Float64}</code>:  integrated dissipation (<span>$\Phi$</span>).</li></ul><p>Other outputs of interest can be computed as follows.   These are in units of <code>l_ref</code>, <code>rho_ref</code>, <code>u_ref</code></p><ul><li><code>beffi</code>: Effective perimeter,  <span>$b_{eff,i} = b_i  +  2 \pi \delta^* dr/dn$</span>.</li><li><code>rhi</code>: Edge density, <span>$\rho_i = (1 + \frac{(\gamma-1)}{2}M^2 (1.0-u_{e,i}^2))^\frac{1}{(\gamma-1)}$</span>.</li><li><code>mdef</code>: Total mass defect, <span>$\rho_i u_{e,i} \delta^* b_{eff}$</span>.</li><li><code>Pdef</code>: Total momentum defect, <span>$\rho_i u_{e,i}^2 \theta b_{eff}$</span>.</li><li><code>Edef</code>: Total kinetic energy defect, <span>$\frac{1}{2} \rho_i u_{e,i}^3 \theta^* b_{eff}$</span>.</li><li><code>tauwb</code>: Wall shear force/span, <span>$\frac{\tau_w}{b} = \frac{1}{2} u_{e,i}^2 c_{f,i} b_{eff}$</span>.</li><li><code>Diss</code>: Dissipation integral, <span>$\rho_i u_{e,i}^3 c_{\mathcal{D},i} b_{eff,i}$</span>.</li></ul><p>Body profile drag <code>D_p</code> is the far-downstream momentum defect <span>$P_\infty$</span>,   best obtained by applying Squire-Young to the last wake point, <span>$i = n$</span> :</p><ul><li><span>$P_{end} = \rho_i u_{e,i}^2 \theta b_{eff}$</span></li><li><span>$H_{end} = \delta^*/\theta$</span></li><li><span>$H_{\infty} = 1 + (\gamma-1) M^2$</span></li><li><span>$H_{avg} = \frac{1}{2} (H_{end} + H_{inf})$</span></li><li><span>$P_{inf} = P_{end} u_{e,i}^{H_{avg}}  =  D_p$</span></li></ul></div></details><p>See Section 4 of <a href="../../assets/drela_TASOPT_2p16/axibl.pdf">Simplified Viscous/Inviscid Analysis for Nearly-Axisymmetric Bodies</a>. See also <a href="#TASOPT.aerodynamics._BL_station_system-NTuple{65, Any}"><code>_BL_station_system</code></a> and <a href="#TASOPT.aerodynamics._BL_station_vars-NTuple{10, Any}"><code>_BL_station_vars</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/axisymm_BL.jl#L1-L63">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics._BL_station_vars-NTuple{10, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics._BL_station_vars-NTuple{10, Any}"><code>TASOPT.aerodynamics._BL_station_vars</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_BL_station_vars(is_selfsimilar, is_laminar, is_wake, Reyn, Mach, fexcr, x, Œ∏, Œ¥s, ue)</code></pre><p>Returns the boundary layer variables needed for solution. Formerly, <code>blvar!()</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-538f9fc965f3d113"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-538f9fc965f3d113" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>is_selfsimilar::Bool</code>: Self-similar BL profile flag.</li><li><code>is_laminar::Bool</code>: Laminar flow flag.</li><li><code>is_wake::Bool</code>: In wake flag.</li><li><code>Reyn::Float64</code>: Reynolds number.</li><li><code>Mach::Float64</code>: Mach number for compressibility.</li><li><code>fexcr::Float64</code>: Excrescence factor.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>h::Float64</code> : Shape parameter.</li><li><code>hk::Float64</code>: Kinematic shape parameter.</li><li><code>hc::Float64</code>: Density shape parameter (Whitfield).</li><li><code>hs::Float64</code>: Kinetic energy shape parameter.</li><li><code>cf::Float64</code>: Skin friction factor.</li><li><code>cd::Float64</code>: Dissipation factor and their derivatives.</li></ul></div></details></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/BL_station_system.jl#L302-L324">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.fuselage_drag!-NTuple{4, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics.fuselage_drag!-NTuple{4, Any}"><code>TASOPT.aerodynamics.fuselage_drag!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fuselage_drag!(fuse, parg, para, ip)</code></pre><p>Calculates surface velocities, boundary layer, wake  for a quasi-axisymmetric body in compressible flow. Formerly, <code>fusebl!()</code>.</p><p>A compressible source line represents the potential flow. An integral BL formulation with lateral divergence represents the surface BL and wake. An added-source distribution represents the viscous displacement influence on the potential flow. The body shape is defined by its area and perimeter distributions <code>A(x)</code>,  <code>b0(x)</code>, which are defined by the various geometric parameters in <code>parg</code>. </p><details class="admonition is-details" id="Inputs-and-Outputs-d22b57354354965d"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-d22b57354354965d" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>fuse::Fuselage</code>: Fuselage model object.</li><li><code>parg::AbstractArray{Float64}</code>: Vector of <code>aircraft</code> model geometry parameters.</li><li><code>para::AbstractArray{Float64}</code>: Vector of <code>aircraft</code> model aerodynamic parameters.</li><li><code>parm::AbstractArray{Float64}</code>: Vector of <code>aircraft</code> model mission parameters.</li><li><code>ip::Integer</code>: Index of flight point in <code>par</code> arrays.</li></ul><p><strong>Outputs:</strong></p><ul><li>No explicit outputs. Computed drag values are saved to <code>para</code> of <code>aircraft</code> model.</li></ul></div></details><p>See <a href="../../assets/drela_TASOPT_2p16/axibl.pdf">Simplified Viscous/Inviscid Analysis for Nearly-Axisymmetric Bodies</a>. See also <a href="#TASOPT.aerodynamics._axisymm_BL-NTuple{10, Any}"><code>_axisymm_BL</code></a> and <a href="#TASOPT.aerodynamics._axisymm_flow-NTuple{16, Any}"><code>_axisymm_flow</code></a>.</p><div class="admonition is-compat" id="Future-Changes-d55963a6d9505ffc"><header class="admonition-header">Future Changes<a class="admonition-anchor" href="#Future-Changes-d55963a6d9505ffc" title="Permalink"></a></header><div class="admonition-body"><p>In an upcoming revision, an <code>aircraft</code> <code>struct</code> and auxiliary indices will be passed in lieu of pre-sliced <code>par</code> arrays.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/fuselage_drag.jl#L3-L32">source</a></section></details></article><hr/><h2 id="trefftz"><a class="docs-heading-anchor" href="#trefftz">Trefftz plane drag calculation</a><a id="trefftz-1"></a><a class="docs-heading-anchor-permalink" href="#trefftz" title="Permalink"></a></h2><p>Trefftz plane analysis computes the induced drag from multiple lifting surfaces (wing + horizontal tail). The lift distributions are propagated downstream, accounting for streamline contraction from fuselage thickness variation as shown in the Figure below.</p><p><img src="../../assets/trefftz.png" alt/> Two shaded streamtubes are shown. Wake center radius <span>$y&#39;_o$</span> is nonzero due to the fuselage viscous wake displacement area.</p><p>The vorticity in the wake is numerically integrated at collocation points to determine the overall induced drag.</p><p><img src="../../assets/tpvort.png" alt="T"/></p><p>Trefftz Plane vortices <span>$i,i\!+\!1 \ldots$</span> and collocation points <span>$i\!+\!1/2$</span> used for velocity, impulse, and kinetic energy calculations. Left/right symmetry is exploited.</p><h3 id="Multi-surface-formulation"><a class="docs-heading-anchor" href="#Multi-surface-formulation">Multi-surface formulation</a><a id="Multi-surface-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-surface-formulation" title="Permalink"></a></h3><p>The induced drag calculation uses a discrete vortex method with a pre-computed influence matrix. For wing and tail surfaces, the system is:</p><p class="math-container">\[\mathbf{A}\boldsymbol{\Gamma} = \mathbf{w}\]</p><p>where <span>$\mathbf{A}$</span> is the aerodynamic influence matrix (purely geometric), <span>$\boldsymbol{\Gamma}$</span> is the wake circulation vector, and <span>$\mathbf{w}$</span> is the normal velocity at control points.</p><p>Each influence coefficient <span>$A_{ij}$</span> represents the velocity induced at control point <span>$i$</span> by a unit vortex at wake point <span>$j$</span>, including its mirror image:</p><p class="math-container">\[A_{ij} = \frac{(\hat{\mathbf{x}} \times \mathbf{r}_{ij}) \cdot \hat{\mathbf{n}}_i}{|\mathbf{r}_{ij}|^2} - \frac{(\hat{\mathbf{x}} \times \mathbf{r}_{ij}^m) \cdot \hat{\mathbf{n}}_i}{|\mathbf{r}_{ij}^m|^2}\]</p><p>where <span>$\mathbf{r}_{ij}$</span> is the vector from wake point <span>$j$</span> to control point <span>$i$</span>, <span>$\mathbf{r}_{ij}^m$</span> is the vector from the mirror image of wake point <span>$j$</span>, and <span>$\hat{\mathbf{n}}_i$</span> is the unit normal of element <span>$i$</span>.</p><p>The influence matrix has block structure for wing-tail interactions:</p><p class="math-container">\[\begin{bmatrix}
\mathbf{A}_{\mathrm{ww}} &amp; \mathbf{A}_{\mathrm{wt}} \\
\mathbf{A}_{\mathrm{tw}} &amp; \mathbf{A}_{\mathrm{tt}}
\end{bmatrix}
\begin{bmatrix} \boldsymbol{\Gamma}_\mathrm{wing} \\ \boldsymbol{\Gamma}_\mathrm{tail}
\end{bmatrix} =
\begin{bmatrix} \mathbf{w}_\mathrm{wing} \\ \mathbf{w}_\mathrm{tail}
\end{bmatrix}\]</p><p>The structure of this block matrix looks like:</p><p class="math-container">\[\small{\left[
\begin{array}{c:c}
	\overbrace{\begin{bmatrix} 
	a_{w_1,w_1}  &amp; a_{w_1,w_2}&amp;\cdots &amp; a_{w_1,w_{n_\mathrm{wing+1}}}\\
	\vdots &amp; \ddots &amp;  &amp; \vdots\\
	\vdots &amp;  &amp;  &amp; \vdots \\
	a_{w_{n_\mathrm{wing}},w_1}  &amp; a_{w_1,w_2}&amp;\cdots &amp; a_{w_{n_\mathrm{wing}},w_{n_\mathrm{wing+1}}}\\
	\end{bmatrix}}^{\mathbf{A}_{n_\mathrm{wing}\times n_\mathrm{wing+1}}}
	&amp;
	\overbrace{\begin{bmatrix} 
	a_{w_1,t_1}  &amp; \cdots &amp; a_{w_1,t_{n_\mathrm{tail+1}}} \\
	\vdots &amp; \ddots &amp; \vdots \\
	\vdots &amp;  &amp;   \vdots \\
	a_{w_{n_\mathrm{wing}},t_1} &amp;\cdots &amp; a_{w_{n_\mathrm{wing}},t_{n_\mathrm{tail+1}}}\\
	\end{bmatrix}}^{\mathbf{A}_{n_\mathrm{wing}\times n_\mathrm{tail+1}}} \\[2em]
	
	\hdashline \\
	
	\underbrace{\begin{bmatrix} 
	a_{t_1,w_1}  &amp; a_{t_1,w_2}&amp;\cdots &amp; a_{t_1,w_{n_\mathrm{wing+1}}}\\
	\vdots &amp; \ddots &amp;  &amp; \vdots\\
	a_{t_{n_\mathrm{tail}},w_1}  &amp; a_{t_1,w_2}&amp;\cdots &amp; a_{t_{n_\mathrm{tail}},w_{n_\mathrm{wing+1}}}\\
	\end{bmatrix}}_{\mathbf{A}_{n_\mathrm{tail}\times n_\mathrm{wing+1}}}
	&amp;
	\underbrace{\begin{bmatrix} 
	a_{t_1,t_1}  &amp; \cdots &amp; a_{t_1,t_{n_\mathrm{tail+1}}} \\
	\vdots &amp; \ddots &amp; \vdots \\
	a_{t_{n_\mathrm{tail}},t_1} &amp;\cdots &amp; a_{t_{n_\mathrm{tail}},t_{n_\mathrm{tail+1}}}\\
	\end{bmatrix}}_{\mathbf{A}_{n_\mathrm{wing}\times n_\mathrm{tail+1}}}
\end{array}
\right]
\quad

\begin{bmatrix}
	\left.\begin{matrix}
		\Gamma_{w_1} \\
		\Gamma_{w_2} \\
		\vdots \\
		\vdots \\
		\Gamma_{w_{n_\mathrm{wing}}}\\
		\Gamma_{w_{n_\mathrm{wing}+1}}
		\end{matrix}\right\} n_{\mathrm{wing}+1} \\[1em]
		\left.\begin{matrix}
		\Gamma_{t_1} \\
		\Gamma_{t_2} \\
		\vdots \\
		\Gamma_{t_{n_\mathrm{tail}}}\\
		\Gamma_{t_{n_\mathrm{tail}+1}}
	\end{matrix}\right\} n_{\mathrm{tail+1}}
\end{bmatrix} =

\begin{bmatrix}
	\left.\begin{matrix}
		w_{w_1} \\
		w_{w_2} \\
		\vdots \\
		\vdots \\
		w_{w_{n_\mathrm{wing}}}
		\end{matrix}\right\} n_\mathrm{wing} \\[1em]
		\left.\begin{matrix}
		w_{t_1} \\
		w_{t_2} \\
		\vdots \\
		w_{t_{n_\mathrm{tail}}}
	\end{matrix}\right\} n_\mathrm{tail}
	 \\
\end{bmatrix}}\]</p><p>The AIC matrix looks like:</p><p><img src="../../assets/trefftz_AIC_spy.png" alt="AIC"/></p><h3 id="Spanwise-point-distribution"><a class="docs-heading-anchor" href="#Spanwise-point-distribution">Spanwise point distribution</a><a id="Spanwise-point-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Spanwise-point-distribution" title="Permalink"></a></h3><p>Points are distributed using a cosine spacing transformation for accuracy at the wing tip where circulation changes rapidly. A &quot;bunching&quot; parameter <span>$\beta \in [0,1]$</span> clusters points toward the root:</p><p class="math-container">\[t_\mathrm{bunched} = t + \beta \cdot t(1-t)\]</p><p>where <span>$t \in [0,1]$</span> is the normalized spanwise coordinate.</p><h3 id="Wake-contraction"><a class="docs-heading-anchor" href="#Wake-contraction">Wake contraction</a><a id="Wake-contraction-1"></a><a class="docs-heading-anchor-permalink" href="#Wake-contraction" title="Permalink"></a></h3><p>Streamlines contract behind the fuselage due to mass conservation. Inside the fuselage region (<span>$y \leq y_o$</span>), a power-law contraction is used:</p><p class="math-container">\[y&#39; = y&#39;_o \left(\frac{y}{y_o}\right)^{(y_o/y&#39;_o)^2}\]</p><p>Outside the fuselage (<span>$y &gt; y_o$</span>), contraction follows mass conservation:</p><p class="math-container">\[y&#39; = \sqrt{y^2 - y_o^2 + {y&#39;_o}^2}\]</p><h3 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h3><p>Panel discretization and physical parameters are specified in the TOML input file:</p><pre><code class="language-toml hljs">[Options]
    trefftz_resolution = &quot;MEDIUM&quot;  # &quot;COARSE&quot;, &quot;MEDIUM&quot;, or &quot;FINE&quot;</code></pre><table><tr><th style="text-align: right">Resolution</th><th style="text-align: right">Wing panels</th><th style="text-align: right">Tail panels</th><th style="text-align: right">Accuracy</th></tr><tr><td style="text-align: right"><code>COARSE</code></td><td style="text-align: right">29</td><td style="text-align: right">12</td><td style="text-align: right">~1.8% error</td></tr><tr><td style="text-align: right"><code>MEDIUM</code></td><td style="text-align: right">56</td><td style="text-align: right">24</td><td style="text-align: right">~0.6% error</td></tr><tr><td style="text-align: right"><code>FINE</code></td><td style="text-align: right">224</td><td style="text-align: right">96</td><td style="text-align: right">Reference</td></tr></table><p>Advanced parameters (usually don&#39;t need to change):</p><pre><code class="language-toml hljs">[Options]
    trefftz_k_tip = 16.0           # Tip loading exponent
    trefftz_bunch = 0.5            # Panel clustering factor [0,1]
    wing_root_contraction = 0.2    # Wake contraction at wing root
    tail_root_contraction = 1.0    # Wake contraction at tail root</code></pre><details class="admonition is-details" id="Theory-induced-drag-C_{d,i}-38917728f95b906e"><summary class="admonition-header">üìñ Theory - induced drag $C_{d,i}$<a class="admonition-anchor" href="#Theory-induced-drag-C_{d,i}-38917728f95b906e" title="Permalink"></a></summary><div class="admonition-body"><p>The induced drag is calculated using a discrete vortex Trefftz-Plane analysis. The circulation of the wing wake immediately behind the trailing edge is </p><p class="math-container">\[\begin{aligned}
\Gamma_{\!{\rm wing}} {\scriptstyle (\eta)}
&amp; = \frac{\tilde{p} {\scriptstyle (\eta)}}{\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}}
\; \simeq \; \frac{p {\scriptstyle (\eta)}}{\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}} \, \sqrt{1 \!-\! \eta^{k_t}}
\\
k_t &amp; \simeq 16
\end{aligned}\]</p><p>where the approximation realistically represents the tip lift rolloff for typical taper ratios, and is consistent with the assumed <span>$f_{L_{\scriptstyle t}}\simeq -0.05$</span> value for the tip lift loss factor. This circulation is convected into the wake along streamlines which will typically constrict behind the fuselage by continuity. The Figure above shows two possible aft fuselage taper shapes, giving two different wake constrictions.</p><p>An annular streamtube at the wing contracts to another annular streamtube in the wake with the same cross-sectional area. The <span>$y$</span> and <span>$y&#39;$</span> locations on the wing and wake which are connected by a streamline are therefore related by the correspondence function. </p><p class="math-container">\[\begin{aligned}
y&#39;{\scriptstyle (y)}&amp; = &amp; \sqrt{ y^2 - y_o^2 + {y&#39;_o}^2}
\end{aligned}\]</p><p>The Trefftz Plane circulation <span>$\Gamma {\scriptstyle (y&#39;)}$</span> is then given by the coordinate shift. The mapping function <span>$y&#39;{\scriptstyle (y)}$</span> is not defined for <span>$y \! &lt; \! y_o$</span>, so the circulation there is simply set from the <span>$y_o$</span> value. </p><p class="math-container">\[\begin{aligned}
\Gamma_{\rm wake} {\scriptstyle (y&#39;)}&amp; = &amp; 
\left\{
\begin{array}{lcl}
\Gamma_{\!{\rm wing}} \left( y {\scriptstyle (y&#39;)}\right)
&amp; , &amp; y \!&gt;\! y_o \\
\Gamma_{\!{\rm wing}} \left( y_o \right)
\end{array}
\right.
\end{aligned}\]</p><p>The Trefftz Plane analysis uses point vortices. The circulation ([Gamwake]) is evaluated at the midpoints of <span>$n$</span> intervals along the wake trace, spaced more or less evenly in the Glauert angle to give a cosine distribution in physical space. The wake&#39;s vertical <span>$z$</span> positions are simply taken directly from the wing. </p><p class="math-container">\[\begin{aligned}
\theta_{i+1/2} &amp; = &amp; \frac{\pi}{2} \, \frac{i-1/2}{n}
\hspace{2ex} , \hspace{2ex} i = 1 \ldots n
\\
y_{i+1/2} &amp; = &amp; \frac{b}{2} \, \cos \theta_{i+1/2}
\\
y&#39;_{i+1/2} &amp; = &amp; \sqrt{y_{i+1/2}^2 - y_o^2 + {y&#39;_o}^2}
\\
z&#39;_{i+1/2} &amp; = &amp; z_{i+1/2}
\\
\Gamma_{\!i+1/2} &amp; = &amp; \Gamma_{\!{\rm wing}} (y_{i+1/2})
\end{aligned}\]</p><p>The locations of <span>$n+1$</span> trailing vortices are computed similarly. </p><p class="math-container">\[\begin{aligned}
\theta_i &amp; = &amp; \frac{\pi}{2} \, \frac{i-1}{n}
\hspace{2ex} , \hspace{2ex} i = 1 \ldots n\!+\!1
\\
y_i &amp; = &amp; \frac{b}{2} \, \cos \theta_i
\\
y&#39;_i &amp; = &amp; \sqrt{y_i^2 - y_o^2 + {y&#39;_o}^2}
\\
z&#39;_i &amp; = &amp; z_i
\end{aligned}\]</p><p>The circulations of these trailing vortices are the differences of the adjacent bound circulations, with the circulation beyond the tips effectively zero. </p><p class="math-container">\[\begin{aligned}
\bar{\Gamma}_{\!i} &amp; = &amp; 
\left\{
\begin{array}{lcl}
\hspace{6.5ex}
-\Gamma_{\!i-1/2} &amp; , &amp; i = 1 \hspace{3.5em} \mathrm{(left tip)}
\\
\Gamma_{\!i+1/2}-\Gamma_{\!i-1/2} &amp; , &amp; i = 2 \ldots n
\\
\Gamma_{\!i+1/2} &amp; , &amp; i = n\!+\!1 \hspace{2em} \mathrm{(right tip)}
\end{array}
\right.
\end{aligned}\]</p><p>The above definitions are also applied to the horizontal tail, with its discrete points simply appended to the list and <span>$n$</span> increased accordingly.</p><p>The Trefftz plane calculation proceeds by first calculating the <span>$y$</span>-<span>$z$</span> wake velocity components at the <span>$y&#39;_{i+1/2},z&#39;_{i+1/2}$</span> interval midpoints, induced by all the trailing vortices and their left-side images. </p><p class="math-container">\[\begin{aligned}
v_{i+1/2} &amp; = &amp; \sum_{j=1}^{n+1} \frac{\bar{\Gamma}_{\!j}}{2\pi} 
\left[
\frac{-(z&#39;_{i+1/2}\!-\!z&#39;_j)}
      {(y&#39;_{i+1/2}\!-\!y&#39;_j)^2
     + (z&#39;_{i+1/2}\!-\!z&#39;_j)^2}
\,-\,
\frac{-(z&#39;_{i+1/2}\!-\!z&#39;_j)}
      {(y&#39;_{i+1/2}\!+\!y&#39;_j)^2
     + (z&#39;_{i+1/2}\!-\!z&#39;_j)^2}
\right]
\hspace{2em}
\\
w_{i+1/2} &amp; = &amp; \sum_{j=1}^{n+1} \frac{\bar{\Gamma}_{\!j}}{2\pi}
\left[
\frac{ y&#39;_{i+1/2}\!-\!y&#39;_j}
     {(y&#39;_{i+1/2}\!-\!y&#39;_j)^2
    + (z&#39;_{i+1/2}\!-\!z&#39;_j)^2}
\,-\,
\frac{ y&#39;_{i+1/2}\!+\!y&#39;_j}
     {(y&#39;_{i+1/2}\!+\!y&#39;_j)^2
    + (z&#39;_{i+1/2}\!-\!z&#39;_j)^2}
\right]
\end{aligned}\]</p><p>The overall lift and induced drag are then computed using the Trefftz Plane vertical impulse and kinetic energy. The sums are doubled to account for the left side image. </p><p class="math-container">\[\begin{aligned}
C_{\!L_{\scriptscriptstyle T\!P}} &amp; = &amp; \frac{2}{{\textstyle \frac{1}{2}}\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}^2 S} \: \sum_{i=1}^{n} 
\: \rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}\, \Gamma_{\!i+1/2} \: (y&#39;_{i+1}-y&#39;_i)
\\
C_{\!D_{\scriptscriptstyle T\!P}} &amp; = &amp; \frac{2}{{\textstyle \frac{1}{2}}\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}^2 S} \: \sum_{i=1}^{n} 
-\frac{\rho_{\scriptscriptstyle \infty}}{2} \, \Gamma_{\!i+1/2} \left[
      w_{i+1/2} \,(y&#39;_{i+1}\!-\!y&#39;_i)
 \:-\:v_{i+1/2} \,(z&#39;_{i+1}\!-\!z&#39;_i) \right]
\end{aligned}\]</p><p>To minimize any modeling and numerical errors incurred in the wake contraction model and the point-vortex summations, the final induced drag value is scaled by the square of the surface-integral and Trefftz-Plane drag values. </p><p class="math-container">\[\begin{aligned}
C_{\!D_i} &amp; = &amp; C_{\!D_{\scriptscriptstyle T\!P}} \left(\frac{C_{\!L}}{C_{\!L_{\scriptscriptstyle T\!P}}} \right)^{\!2}
\end{aligned}\]</p><p>This is equivalent to using the Trefftz Plane analysis to calculate the span efficiency rather than the actual induced drag coefficient.</p></div></details><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.TrefftzPlaneConfig"><a class="docstring-binding" href="#TASOPT.aerodynamics.TrefftzPlaneConfig"><code>TASOPT.aerodynamics.TrefftzPlaneConfig</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">TrefftzPlaneConfig</code></pre><p>Configuration for Trefftz plane induced drag analysis. Contains both panel discretization and analysis constants/ parameters.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">config = TrefftzPlaneConfig(
    wing_panels = SurfaceDiscretization(40, 12, 6),
    tail_panels = SurfaceDiscretization(20, 0, 4),
    k_tip = 16.0,
    bunch = 0.5,
    wing_root_contraction = 0.2,
    tail_root_contraction = 1.0
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/trefftz_config.jl#L22-L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.SurfaceDiscretization"><a class="docstring-binding" href="#TASOPT.aerodynamics.SurfaceDiscretization"><code>TASOPT.aerodynamics.SurfaceDiscretization</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><p>Struct to hold the discretization parameters for surface panels in the far field drag estimates in the Trefftz Plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/trefftz_config.jl#L4-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.get_trefftz_config"><a class="docstring-binding" href="#TASOPT.aerodynamics.get_trefftz_config"><code>TASOPT.aerodynamics.get_trefftz_config</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_trefftz_config(quality::String; k_tip=16.0, bunch=0.5, wing_root_contraction=0.2, tail_root_contraction=1.0)</code></pre><p>Create a <a href="#TASOPT.aerodynamics.TrefftzPlaneConfig"><code>TrefftzPlaneConfig</code></a>.</p><details class="admonition is-details" id="Inputs-and-Outputs-d028c30ccd016c3e"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-d028c30ccd016c3e" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>quality::String</code>: Discretization quality level (&quot;COARSE&quot;, &quot;MEDIUM&quot;, or &quot;FINE&quot;).</li><li><code>k_tip::Float64=16.0</code>: Tip loading exponent (controls circulation decay at wing tips).</li><li><code>bunch::Float64=0.5</code>: Center clustering factor ‚àà [0,1] (controls spanwise panel spacing near root).</li><li><code>wing_root_contraction::Float64=0.2</code>: Wing root streamline contraction factor (stream tube contraction near fuselage).</li><li><code>tail_root_contraction::Float64=1.0</code>: Tail root streamline contraction factor (typically 1.0 = no contraction).</li></ul><p><strong>Outputs:</strong></p><ul><li><code>TrefftzPlaneConfig</code>: Complete configuration for Trefftz plane induced drag analysis.</li></ul></div></details><div class="admonition is-info" id="Quality-Levels-c16ede370256775d"><header class="admonition-header">Quality Levels<a class="admonition-anchor" href="#Quality-Levels-c16ede370256775d" title="Permalink"></a></header><div class="admonition-body"><ul><li><strong>&quot;FINE&quot;</strong> (328 panels): Reference accuracy, slowest<ul><li>Wing: 160 outer, 48 inner, 24 image</li><li>Tail: 80 outer, 0 inner, 16 image</li></ul></li><li><strong>&quot;MEDIUM&quot;</strong> (84 panels): ~0.6% higher CDi vs FINE,<ul><li>Wing: 40 outer, 12 inner, 6 image</li><li>Tail: 20 outer, 0 inner, 4 image</li></ul></li><li><strong>&quot;COARSE&quot;</strong> (43 panels): ~1.8% higher CDi vs FINE, fastest<ul><li>Wing: 20 outer, 6 inner, 3 image</li><li>Tail: 10 outer, 0 inner, 2 image</li></ul></li></ul></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/trefftz_config.jl#L100-L126">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.induced_drag!"><a class="docstring-binding" href="#TASOPT.aerodynamics.induced_drag!"><code>TASOPT.aerodynamics.induced_drag!</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">  induced_drag!(para, wing, htail, trefftz_config)</code></pre><p>Computes the induced drag via the Trefftz plane using a discrete vortex method. Formerly, <code>cditrp!()</code> but now broken up into smaller functions.</p><details class="admonition is-details" id="Inputs-and-Outputs-e76b8dc80e125fd2"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-e76b8dc80e125fd2" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>para::AbstractArray{Float64}</code>: Array of <code>aircraft</code> model aerodynamic parameters.</li><li><code>wing::TASOPT.Wing</code>: Wing Structure.</li><li><code>htail::TASOPT.Tail</code>: Htail Structure.</li><li><code>trefftz_config::TrefftzPlaneConfig</code>: Trefftz plane analysis configuration (panel discretization and analysis parameters).</li></ul><p><strong>Outputs:</strong></p><ul><li>No explicit outputs. Computed induced drag value and span efficiency are saved to <code>para</code> of <code>aircraft</code> model.</li></ul></div></details><div class="admonition is-compat" id="Future-Changes-d55963a6d9505ffc"><header class="admonition-header">Future Changes<a class="admonition-anchor" href="#Future-Changes-d55963a6d9505ffc" title="Permalink"></a></header><div class="admonition-body"><p>In an upcoming revision, an <code>aircraft</code> <code>struct</code> and auxiliary indices will be passed in lieu of pre-sliced <code>par</code> arrays.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/induced_drag.jl#L1-L20">source</a></section></details></article><h4 id="Wake-geometry-types"><a class="docs-heading-anchor" href="#Wake-geometry-types">Wake geometry types</a><a id="Wake-geometry-types-1"></a><a class="docs-heading-anchor-permalink" href="#Wake-geometry-types" title="Permalink"></a></h4><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.WakeSystem"><a class="docstring-binding" href="#TASOPT.aerodynamics.WakeSystem"><code>TASOPT.aerodynamics.WakeSystem</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct WakeSystem{NP, NE}</code></pre><p>A complete wake system with N wake points forming N-1 wake elements.</p><p><strong>Type Parameters</strong></p><ul><li><p><code>points::StaticArraysCore.SVector{NP, StaticArraysCore.SVector{2, Float64}} where NP</code></p></li><li><p><code>elements::StaticArraysCore.SVector{NE, TASOPT.aerodynamics.WakeElement} where NE</code></p></li><li><p><code>influence_matrix::Matrix{Float64}</code></p></li></ul><p>The <code>influence_matrix</code> is purely geometric! So compute once and reuse it for different loading conditions. For each element-point pair, the coefficient is:</p><p class="math-container">\[\left(\hat{x} \times (\mathbf{r}_{cp} - \mathbf{r}_{wp})\right) \cdot \hat{n}\]</p><p>where:</p><ul><li><span>$\hat{x}$</span> is the unit vector in x-direction</li><li><span>$\mathbf{r}_{cp}$</span> is the control point position vector</li><li><span>$\mathbf{r}_{wp}$</span> is the wake point position vector</li><li><span>$\hat{n}$</span> is the unit normal to the wake element</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/WakeGeometry.jl#L106-L124">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.WakeElement"><a class="docstring-binding" href="#TASOPT.aerodynamics.WakeElement"><code>TASOPT.aerodynamics.WakeElement</code></a> ‚Äî <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct WakeElement</code></pre><p>Represents a single wake element defined by two points in the y-z plane and a control point. Note the control point does <em>not</em> have to be the midpoint, but it defaults to that if nothing is provided.</p><p><strong>Fields</strong></p><ul><li><p><code>p1</code>: Starting point of the wake element</p></li><li><p><code>p2</code>: Ending point of the wake element</p></li><li><p><code>control_point</code>: Control point (midpoint) of the element</p></li><li><p><code>length</code>: Length of element</p></li><li><p><code>Œîy</code>: y-extent of element</p></li><li><p><code>Œîz</code>: z-extent of element</p></li><li><p><code>unit_normal</code>: Unit normal vector to the element</p></li></ul><p>It store a few more things inside WakeElement to help with calculations later. The unit normal is computed as [Œîz, -Œîy]/|Œîs| where Œîs is the vector connecting the end points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/WakeGeometry.jl#L23-L35">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.calculate_influence_coefficient"><a class="docstring-binding" href="#TASOPT.aerodynamics.calculate_influence_coefficient"><code>TASOPT.aerodynamics.calculate_influence_coefficient</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calculate_influence_coefficient(r_vec, normal)</code></pre><p>Returns the 2D vortex influence coefficient induced at a control point by a unit vortex at the wake point. </p><p><code>r_vec</code> is the displacement vector <code>[Œîy, Œîz]</code> from the vortex to the evaluation point. ‚üπ<code>n‚ãÖ(xÃÇ √ó r)/|r|¬≤</code>,   <code>= (-ny*z + nz*y)/|r|¬≤  ‚ü∏ xÃÇ √ó r = [-z, y]</code></p><p>If <span>$\left|r^2\right|$</span> is below a threshold (<code>MIN_DISTANCE_SQUARED</code>), the value is clipped to zero to avoid singularities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/WakeGeometry.jl#L166-L177">source</a></section></details></article><h4 id="Helper-functions"><a class="docs-heading-anchor" href="#Helper-functions">Helper functions</a><a id="Helper-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-functions" title="Permalink"></a></h4><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.bunch_transform"><a class="docstring-binding" href="#TASOPT.aerodynamics.bunch_transform"><code>TASOPT.aerodynamics.bunch_transform</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">bunch_transform(t, bunch)</code></pre><p>Apply bunching transformation to input <code>t ‚àà \[0,1\]</code>.</p><p>Transforms <code>t</code> to cluster points near the center (t=0.5) when <code>bunch &gt; 0</code>. The transformation is: <code>t_bunched = t + bunch * t * (1 - t)</code></p><details class="admonition is-details" id="Inputs-and-Outputs-dc83fd59a60b6abb"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-dc83fd59a60b6abb" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>t::Float64</code>: Original normalized angle ‚àà [0,1].</li><li><code>bunch::Float64</code>: Clustering factor ‚àà [0,1]. Higher values cluster more points near center.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>t_bunched::Float64</code>: Transformed parameter value.</li></ul></div></details><p>See also <a href="#TASOPT.aerodynamics.inv_bunch_transform"><code>inv_bunch_transform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/induced_drag.jl#L114-L131">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.inv_bunch_transform"><a class="docstring-binding" href="#TASOPT.aerodynamics.inv_bunch_transform"><code>TASOPT.aerodynamics.inv_bunch_transform</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">inv_bunch_transform(t_bunched, bunch)</code></pre><p>Inverse of the bunching transformation. Recovers original <code>t</code> from bunched value.</p><p>Solves <code>t_bunched = t + bunch * t * (1 - t)</code> for <code>t</code> using the quadratic formula. See also <a href="#TASOPT.aerodynamics.bunch_transform"><code>bunch_transform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/induced_drag.jl#L136-L143">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.calculate_wake_circulation!"><a class="docstring-binding" href="#TASOPT.aerodynamics.calculate_wake_circulation!"><code>TASOPT.aerodynamics.calculate_wake_circulation!</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">calculate_wake_circulation!(gw, gc, ifrst, ilast, nsurf)</code></pre><p>Compute wake vortex circulation from bound circulation <code>Œ≥_wake = -dŒì/dy</code>.</p><p>At each panel edge, the change in bound circulation is shed into the wake:</p><ul><li>Root: <code>gw = 0</code> (no upstream circulation at the center of the fuselage)</li><li>Interior: <code>gw[i] = gc[i-1] - gc[i]</code> </li><li>Tip: <code>gw[i] = gc[i-1]</code> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/induced_drag.jl#L148-L157">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.scale_circulation!"><a class="docstring-binding" href="#TASOPT.aerodynamics.scale_circulation!"><code>TASOPT.aerodynamics.scale_circulation!</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">scale_circulation!(gc, gw, yp, ifrst, ilast, CLsurfsp, bref, Sref, nsurf)</code></pre><p>Scale circulation distribution to match specified specified lift coefficient for each surface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/induced_drag.jl#L180-L184">source</a></section></details></article><hr/><h2 id="Wing-and-tail-surfaces"><a class="docs-heading-anchor" href="#Wing-and-tail-surfaces">Wing and tail surfaces</a><a id="Wing-and-tail-surfaces-1"></a><a class="docs-heading-anchor-permalink" href="#Wing-and-tail-surfaces" title="Permalink"></a></h2><p>Lifting surface drag is determined via <a href="#TASOPT.aerodynamics.wing_profiledrag_scaled-NTuple{15, Any}"><code>wing_profiledrag_scaled</code></a> (when constant airfoil section <code>cdf</code> and <code>cdp</code> are already determined), and <a href="#TASOPT.aerodynamics.wing_profiledrag_direct-NTuple{13, Any}"><code>wing_profiledrag_direct</code></a> (when an explicit modelling and integration is desired). Airfoil performance is accessed via a lookup of precomputed airfoil data, <code>airfun</code>.</p><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.wing_profiledrag_direct-NTuple{13, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics.wing_profiledrag_direct-NTuple{13, Any}"><code>TASOPT.aerodynamics.wing_profiledrag_direct</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">  wing_profiledrag_direct(wing, Œ≥t, Œ≥s,
        Mach, CL, CLhtail, 
        Reco, aRexp, kSuns, fexcd,
        fduo, fdus, fdut)</code></pre><p>Calculates wing or tail surface profile <code>CD</code> by calculating the performance of wing segments explicitly via airfoil data (found in [<code>./src/air/C.air</code>] and accessed by [<code>airfun</code>], [<code>airtable</code>]). Called by <a href="#TASOPT.aerodynamics.aircraft_drag!-Tuple{Any, Int64, Int64, Bool}"><code>aircraft_drag!</code></a> if <code>computes_wing_direct</code> flag set to true. Formerly, <code>surfcd2()</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-363abc71fc5a1351"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-363abc71fc5a1351" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>Wing::TASOPT.Wing</code>: Wing Structure.</li><li><code>Œ≥t::Float64</code>: Outer-panel load  taper ratio  pt/po.</li><li><code>Œ≥s::Float64</code>: Inner-panel load  taper ratio  ps/po.</li><li><code>Mach::Float64</code>: Mach number.</li><li><code>CL::Float64</code>: Wing CL.</li><li><code>CLhtail::Float64</code>: Htail CL.</li><li><code>Reco::Float64</code>: Reynolds number for co.</li><li><code>aRexp::Float64</code>: Re-scaling exponent.</li><li><code>kSuns::Float64</code>: Shock-unsweep area constant.</li><li><code>fexcd::Float64</code>: Excrescence cd scaling factor.</li><li><code>fduo::Float64</code>, <code>fdus::Float64</code>, <code>fdut::Float64</code>: Velocity-change fractions at wing root, break (&quot;snag&quot;), and tip due to fuselage flow.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>clpo::Float64</code>,<code>clps::Float64</code>,<code>clpt::Float64</code>: Perpendicular sectional lift coefficient at wing root, break (&quot;snag&quot;), and tip.</li><li><code>CDfwing::Float64</code>: Friction profile cd in perp. plane.</li><li><code>CDpwing::Float64</code>: Pressure profile cd in perp. plane.</li><li><code>CDwing::Float64</code>: Overall profile CD.</li><li><code>CDover::Float64</code>: Fuselage added CD due to lift carryover.</li></ul></div></details><p>See Sections 2.14.3 and 3.8.3 of TASOPT Technical Desc. See also <a href="#TASOPT.aerodynamics.aircraft_drag!-Tuple{Any, Int64, Int64, Bool}"><code>aircraft_drag!</code></a>, <a href="#TASOPT.aerodynamics.wing_profiledrag_scaled-NTuple{15, Any}"><code>wing_profiledrag_scaled</code></a>, [<code>wing_CM</code>], and [<code>airfun</code>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/wing_drag.jl#L1-L33">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.wing_profiledrag_scaled-NTuple{15, Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics.wing_profiledrag_scaled-NTuple{15, Any}"><code>TASOPT.aerodynamics.wing_profiledrag_scaled</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">wing_profiledrag_scaled(S, 
b, bs, bo, 
Œªt, Œªs, sweep, 
co, cdf, cdp, 
Reco, Reref, 
aRexp, kSuns, fCDcen)</code></pre><p>Computes wing or tail surface profile CD from pre-computed chord quantities and corrections. Called by <a href="#TASOPT.aerodynamics.aircraft_drag!-Tuple{Any, Int64, Int64, Bool}"><code>aircraft_drag!</code></a> if <code>computes_wing_direct</code> flag set to false. Formerly, <code>surfcd()</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-64bbd6f94cbae6b8"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-64bbd6f94cbae6b8" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>S::Float64</code>: reference area.</li><li><code>b::Float64</code>: span.</li><li><code>bs::Float64</code>: outer panel break span.</li><li><code>bo::Float64</code>: wing-root (fuselage) span.</li><li><code>Œªt::Float64</code>: outer-panel taper ratio  <span>$ct/co$</span>.</li><li><code>Œªs::Float64</code>: inner-panel taper ratio  <span>$cs/co$</span>.</li><li><code>sweep::Float64</code>: wing sweep, degrees.</li><li><code>co::Float64</code>: wing root chord.</li><li><code>cdf::Float64</code>: friction profile cd.</li><li><code>cdp::Float64</code>: pressure profile cd.</li><li><code>Reco::Float64</code>: Reynolds number for co.</li><li><code>Reref::Float64</code>: reference Reynolds number for cd scaling.</li><li><code>aRexp::Float64</code>: Re-scaling exponent.</li><li><code>kSuns::Float64</code>: shock-unsweep area constant.</li><li><code>fCDcen::Float64</code> : related to fraction of wing BLI (see Eqns. 619 - 621).</li></ul><p><strong>Outputs:</strong></p><ul><li><code>CDsurf</code>: overall profile CD.</li><li><code>CDover</code>: fuselage added CD due to lift carryover.</li></ul></div></details><p>See Sections 2.14.3 and 3.8.3 of the <a href="../../misc/dreladocs/#dreladocs">TASOPT Technical Desc</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/wing_drag.jl#L162-L197">source</a></section></details></article><h3 id="Airfoil-section-data"><a class="docs-heading-anchor" href="#Airfoil-section-data">Airfoil section data</a><a id="Airfoil-section-data-1"></a><a class="docs-heading-anchor-permalink" href="#Airfoil-section-data" title="Permalink"></a></h3><p>The wing airfoil performance is represented by a parameterized transonic airfoil family spanning a range of thicknesses, whose performance is determined by 2D viscous/inviscid CFD calculation for a range of lift coefficients and Mach numbers. Together with suitable sweep corrections, this gives reliable profile+wave drag of the wing in cruise and high climb and high descent.</p><p>The pressure and friction drag coefficients for the wing are obtained from the 2D drag database via cubic interpolation. For the databases provided, each airfoil has been designed (by Mark Drela) for a well-defined transonic drag rise, so that the database returns <span>$c_{d_f}$</span> and <span>$c_{d_p}$</span> values representative of the best transonic airfoil technology.</p><p>Specifically, the perpendicular-plane friction and pressure drag coefficients are then obtained from the  database having the form </p><p class="math-container">\[\begin{aligned}
c_{d_f} &amp; = &amp; 
f_{\rm w_{excr}} \:
\bar{c}_{d_f}(c_{\ell_{\scriptscriptstyle \perp}},M_{\scriptscriptstyle \perp}, {\textstyle \frac{t}{c}} ) 
             \left( \frac{R\!e_c}{R\!e_{\rm ref}} \right)^{\! a_{\scriptscriptstyle Re}} \\
c_{d_p} &amp; = &amp; 
f_{\rm w_{excr}} \:
\bar{c}_{d_p}(c_{\ell_{\scriptscriptstyle \perp}},M_{\scriptscriptstyle \perp}, {\textstyle \frac{t}{c}} ) 
             \left( \frac{R\!e_c}{R\!e_{\rm ref}} \right)^{\! a_{\scriptscriptstyle Re}} \\
\mathrm{where} 
\hspace{5ex}
M_{\scriptscriptstyle \perp}&amp; = &amp; M_{{\scriptscriptstyle \infty}}\, \cos \Lambda \\
\textstyle \frac{t}{c} &amp; = &amp; \bar{h} \\
R\!e_c&amp; = &amp; \frac{\rho_{\scriptscriptstyle \infty}V_{\!{\scriptscriptstyle \infty}}\,c}{\mu_{\scriptscriptstyle \infty}} \\
a_{\scriptscriptstyle Re}&amp; \simeq &amp; -0.15
\end{aligned}\]</p><p>and <span>$f_{\rm w_{excr}} \geq 1$</span> is an empirical specified factor to account for wing excrescence drag sources, and <span>$R\!e_{\rm ref}$</span> is a reference Reynolds number at which the database functions <span>$\bar{c}_{d_f}, \bar{c}_{d_p}$</span> were computed. The chord Reynolds number <span>$R\!e_c$</span> could of course be treated as an additional parameter in the database, but at a considerable increase in the size of the database and the computational effort needed to construct it. The value of the Re-scaling exponent <span>$a_{\scriptscriptstyle Re}\simeq -0.15$</span> is appropriate for fully-turbulent flow. See the theory üìñ block below for more details.</p><details class="admonition is-details" id="Theory-Airfoil-database-lookup-1f0be54f68007207"><summary class="admonition-header">üìñ Theory - Airfoil database lookup<a class="admonition-anchor" href="#Theory-Airfoil-database-lookup-1f0be54f68007207" title="Permalink"></a></summary><div class="admonition-body"><h2>The drag database</h2><p>The airfoil drag database (e.g., <code>C.air</code>) store the 2D airfoil section drag (<span>$c_{d,p},\ c_{d,f}$</span>) and pitching moment (<span>$c_m$</span>) as a function of:</p><ul><li>airfoil thickness/chord ratio, <span>$\tau = \frac{t}{c}$</span>,</li><li>section lift coefficient, <span>$c_l$</span>, and</li><li>Mach number, <span>$M$</span>.</li></ul><p>The <a href="@ref TASOPT.aerodynamics.airtable"><code>airtable</code></a> function builds an <code>airfoil</code> structure that stores the database <span>$\tau, c_l, M$</span> as well as the derivatives at the <em>knots</em> (as described below) to use for cubic interpolation.</p><h2>Cubic interpolation</h2><p>Below is a terse description of the cubic interpolation as relevant to the drag interpolation. There are several online resources available for a more in-depth description of the topic.</p><p>The cubic polynomials are represented as:</p><p class="math-container">\[\newcommand{\im}{{i-1}}
\newcommand{\ip}{{i+1}}
\newcommand{\p}[1]{{#1 + 1}}
\newcommand{\m}[1]{{#1 - 1}}
q_i(t) = (1-t)y_\m{i} + ty_i + t(1-t)\left((1-t)a_i - tb_i\right),\\\]</p><p>where,</p><p class="math-container">\[\newcommand{\im}{{i-1}}
\newcommand{\ip}{{i+1}}
\newcommand{\p}[1]{{#1 + 1}}
\newcommand{\m}[1]{{#1 - 1}}
\begin{aligned}

t &amp;= \frac{x- x_\im}{x_i - x_\im}\\
a_i &amp;= k_\m{i}(x_i - x_\m{i}) - (y_i - y_\m{i}),\\
b_i &amp;= k_i(x_i - x_\m{i})  - (y_i - y_\m{i})

\end{aligned}\]</p><p>and </p><p class="math-container">\[k_i = \left. \frac{\mathrm{d} y}{\mathrm{d} x} \right|_i\]</p><p>is the slope at the <span>$i^{th}$</span> point in the interpolation array.</p><p>These slopes (in each direction) are calculated and stored in the <code>airfoil.A</code> structure by the <a href="@ref TASOPT.aerodynamics.airtable"><code>airtable</code></a> function.</p><p>For brevity only an example of how these are stored is depicted below, the interested user may directly read <code>airtable</code> to see the matrix structure where the knots are stored. Here is an example of taking a slice of the 3-D array storing <span>$c_{d_p}$</span> at a fixed <span>$c_l = c_{l_i}$</span> (the data is really a 4-D array with each of the drag components, <span>$c_{d,p},\ c_{d,f}$</span>, and <span>$c_m$</span> being stored along the 4<span>$^\mathrm{th}$</span> dimension),</p><p class="math-container">\[\newcommand{\pder}[3]{\frac{\partial^{#1} #2}{\partial #3^{#1}} }
\begin{aligned}
\mathbf{A}[c_{l_i}, :, :] &amp;= 
\begin{bmatrix}
	\left. c_{d_p}\right._{\tau_1, M_1}&amp; \left. c_{d_p}\right._    {\tau_1, M_2} &amp; \cdots &amp; \left. c_{d_p}\right._{\tau_1,     M_N} \\
	\left. c_{d_p}\right._{\tau_1, M_2}&amp; \cdots&amp; \cdots &amp;     \left. c_{d_p}\right._{\tau_2, M_N}\\
	\vdots &amp; \ddots &amp; &amp; \vdots \\
	\left. c_{d_p}\right._{\tau_N, M_1}&amp; \cdots&amp; \cdots &amp;     \left. c_{d_p}\right._{\tau_N, M_N}\\
	
&amp; \\
\end{bmatrix}\\ 
\\

\pder{}{\mathbf{A}[c_{l_i}, :, :] }{M} &amp; =
\begin{bmatrix}
	\left. \pder{}{c_{d_p}}{M} \right|_{1,1}&amp; \cdots &amp; \left.     \pder{}{c_{d_p}}{M} \right|_{1,N} \\
	\vdots &amp; \ddots &amp;  \vdots \\
	\left. \pder{}{c_{d_p}}{M} \right|_{N,1}&amp; \cdots &amp; \left.     \pder{}{c_{d_p}}{M} \right|_{N,N} \\
&amp; \\
\end{bmatrix}\\	

\end{aligned}\]</p><p>Similarly, the slopes in the <span>$\tau$</span> direction are stored in <code>A_œÑ</code> and the cross-derivatives are stored in <code>A_M_œÑ</code> and so on. </p><h2>Evaluating the drag calculations</h2><p>The stored slopes are used to evaluate the drag components by first locating the interval to use based on the <span>$c_l, \tau, M$</span> values in the call to <a href="@ref TASOPT.aerodynamics.airfun"><code>airfun</code></a>, and then performing the interpolation in each dimension sequentially. For any values outside the provided database, a quadratic drag penalty is added.  </p></div></details><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.airtable-Tuple{Any}"><a class="docstring-binding" href="#TASOPT.aerodynamics.airtable-Tuple{Any}"><code>TASOPT.aerodynamics.airtable</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">airtable(fname)</code></pre><p>Reads airfoil file and outputs the matrix and splines as an <code>airfoil</code>.</p><p>The airfoil data is stored as a function of three variables, typically Mach number <span>$\mathrm{Ma}$</span>, lift coefficient <span>$c_l$</span>, and thickness to chord ratio <span>$\tau$</span>.</p><pre><code class="language-julia hljs">cdf(Ma, cl, œÑ), cdp(Ma, cl, œÑ), cm(Ma, cl, œÑ)</code></pre><details class="admonition is-details" id="Inputs-and-Outputs-fc73bd202759dd57"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-fc73bd202759dd57" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong></p><ul><li><code>fname::String</code>: Path to file.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>airf::TASOPT.aerodynamics.airfoil</code>: <code>struct</code> with airfoil performance characteristics.</li></ul></div></details></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/airtable.jl#L1-L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.airfun-Tuple{Any, Any, Any, TASOPT.aerodynamics.airfoil}"><a class="docstring-binding" href="#TASOPT.aerodynamics.airfun-Tuple{Any, Any, Any, TASOPT.aerodynamics.airfoil}"><code>TASOPT.aerodynamics.airfun</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">airfun(cl, œÑ, Mach, air::airfoil)</code></pre><p>Looks up airfoil performance data at specified conditions, as precomputed and found in <code>./src/airfoil_data/</code>.</p><details class="admonition is-details" id="Inputs-and-Outputs-4b69b68c1c8884f0"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-4b69b68c1c8884f0" title="Permalink"></a></summary><div class="admonition-body"><p><strong>Inputs:</strong>      </p><ul><li><code>cl::Float64</code>: Airfoil section lift coefficient.</li><li><code>œÑ::Float64</code>: Airfoil section thickness-to-chord ratio.</li><li><code>Mach::Float64</code>: Mach number.</li><li><code>air::TASOPT.aerodynamics.airfoil</code>: <code>airfoil</code> structure with performance data.</li></ul><p><strong>Outputs:</strong></p><ul><li><code>cdf::Float64</code>: Airfoil section skin friction drag.</li><li><code>cdp::Float64</code>: Airfoil section pressure drag.</li><li><code>cdw::Float64</code>: Airfoil section wave drag (unused and assumed 0 here; placeholder left for future implementation).</li><li><code>cm::Float64</code>: Airfoil section pitching moment.</li></ul></div></details></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/airfun.jl#L11-L28">source</a></section></details></article><hr/><h2 id="Total-drag-calculation"><a class="docs-heading-anchor" href="#Total-drag-calculation">Total drag calculation</a><a id="Total-drag-calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Total-drag-calculation" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.aircraft_drag!-Tuple{Any, Int64, Int64, Bool}"><a class="docstring-binding" href="#TASOPT.aerodynamics.aircraft_drag!-Tuple{Any, Int64, Int64, Bool}"><code>TASOPT.aerodynamics.aircraft_drag!</code></a> ‚Äî <span class="docstring-category">Method</span></summary><section><div><p>aircraft<em>drag!(ac, imission, ip, computes</em>wing_direct)</p><p>Calculates aircraft <code>CD</code> components for operating point, ipoint. If <code>computes_wing_direct</code> is <code>true</code>, computes wing <code>cdf</code>,<code>cdp</code> from airfoil database # <code>iairf</code>, otherwise uses default values in para array.  Called by <a href="../../sizing/sizing/#TASOPT._mission_iteration!-Tuple{Any, Any, Any}"><code>_mission_iteration!()</code></a>, <a href="../../sizing/sizing/#TASOPT.size_aircraft!"><code>size_aircraft!</code></a>, and <a href="../../sizing/sizing/#TASOPT.takeoff!-Tuple{Any}"><code>takeoff!</code></a>. Formerly, <code>cdsum!()</code>.</p><p>The total drag is computed by</p><p class="math-container">\[C_{D} = C_{D, i} + C_{D,fuse} + C_{D,wing} + C_{D,over} + C_{D,htail} + C_{D,vtail} + C_{D,strut} + C_{D,nace} + \Delta C_{D,BLI,f} + \Delta C_{D,BLI,w}\]</p><p>where:</p><ul><li><span>$C_{D,i}$</span> (<code>CDi</code>) is the total induced drag including the wing and tail,</li><li><span>$C_{D,fuse}$</span> (<code>CDfuse</code>) is the fuselage profile drage computed by solving a boundary layer integral equation,</li><li><span>$C_{D,wing}$</span> (<code>CDwing</code>) is the wing profile drag (viscous + pressure) computed using airfoil data obtained from CFD,</li><li><span>$C_{D,over}$</span> (<code>CDover</code>) is the fuselage added CD due to lift carryover,</li><li><span>$C_{D,htail}$</span> (<code>CDhtail</code>) is the horizontal tail profile drag computed from assumed drag coefficients,</li><li><span>$C_{D,vtail}$</span> (<code>CDvtail</code>) is the vertical tail profile drag computed from assumed drag coefficients,</li><li><span>$C_{D,strut}$</span> (<code>CDstrut</code>) is the strut profile drag, </li><li><span>$C_{D,nace}$</span> (<code>CDnace</code>) is the nacelle profile drag,</li><li><span>$\Delta C_{D,BLI,f}$</span> (<code>dCDBLIf</code>) is related to the boundary layer ingestion on the fuselage,</li><li>and <span>$\Delta C_{D,BLI,w}$</span> (<code>dCDBLIw</code>) is related to the boundary layer ingestion on the wing.</li></ul><details class="admonition is-details" id="Inputs-and-Outputs-b6e7418643b668c3"><summary class="admonition-header">üîÉ Inputs and Outputs<a class="admonition-anchor" href="#Inputs-and-Outputs-b6e7418643b668c3" title="Permalink"></a></summary><div class="admonition-body"></div></details><p><strong>Inputs:</strong>       - <code>ac::aircraft</code>: aircraft data storage object       - <code>imission::Int64</code>: mission index       - <code>ip::Int64</code>: operating point index       - <code>computes_wing_direct::Bool</code>: Flag if drag should be computed with <code>wing_profiledrag_direct</code> (true) or if para values should be used (false).</p><pre><code class="language-julia hljs">  **Outputs:**
  - No explicit outputs. Computed drag values are saved to `para` of `aircraft` model.</code></pre><p>See Section 2.14 of the <a href="../../misc/dreladocs/#dreladocs">TASOPT Technical Desc</a>. See also <a href="../../sizing/sizing/#TASOPT.aerodynamics.fuselage_drag!"><code>fuselage_drag!</code></a>, <a href="#TASOPT.aerodynamics.wing_profiledrag_direct-NTuple{13, Any}"><code>wing_profiledrag_direct</code></a>, <a href="#TASOPT.aerodynamics.wing_profiledrag_scaled-NTuple{15, Any}"><code>wing_profiledrag_scaled</code></a>, <a href="#TASOPT.aerodynamics.cfturb"><code>cfturb</code></a>, and <a href="#TASOPT.aerodynamics.induced_drag!"><code>induced_drag!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/drag.jl#L1-L41">source</a></section></details></article><hr/><h2 id="Other-utilities"><a class="docs-heading-anchor" href="#Other-utilities">Other utilities</a><a id="Other-utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Other-utilities" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="TASOPT.aerodynamics.cfturb"><a class="docstring-binding" href="#TASOPT.aerodynamics.cfturb"><code>TASOPT.aerodynamics.cfturb</code></a> ‚Äî <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">  cfturb(Re)</code></pre><p>Returns the total <span>$C_f$</span> for turbulent flat plate (one side) as a function of <span>$\mathrm{Re}_l$</span></p><p class="math-container">\[C_{f, turb} = \frac{0.523}{(\log(0.06\mathrm{Re}))^2} \]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MIT-LAE/TASOPT.jl/blob/b56807cac3d61c35a3f817be9679102ee4202cf2/src/aero/drag.jl#L226-L236">source</a></section></details></article><p>For example, the turbulent flat plate <span>$C_f$</span> for a <span>$Re$</span> of <span>$10e6$</span> can be calculated as follows:</p><pre><code class="language-julia hljs">Re = 10e6
cfturb(Re)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.002954557862895432</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lift/">¬´ Lift</a><a class="docs-footer-nextpage" href="../moment/">Pitching moment ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 30 January 2026 15:52">Friday 30 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
